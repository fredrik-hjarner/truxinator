const e=()=>"undefined"!=typeof window&&!("Deno"in window),t=function(){const e="undefined"!=typeof document&&document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),i={},s=function(e,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=e?.nonce||e?.getAttribute("nonce");a=Promise.allSettled(s.map((e=>{if((e=function(e){return"/schmupinator/"+e}(e))in i)return;i[e]=!0;const s=e.endsWith(".css"),a=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=s?"stylesheet":t,s||(o.as="script"),o.crossOrigin="",o.href=e,n&&o.setAttribute("nonce",n),document.head.appendChild(o),s?new Promise(((t,i)=>{o.addEventListener("load",t),o.addEventListener("error",(()=>i(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then((t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)}))};let n=Date;if(!e())if("undefined"==typeof window){const e=(await s((async()=>{const{performance:e}=await Promise.resolve().then((()=>Ts));return{performance:e}}),void 0))?.performance;e&&(n=e)}else"Deno"in window&&(n=performance);const a=e()?(await s((async()=>{const{default:e}=await import("./PixelMicro.js");return{default:e}}),[])).default:"",o=e()?new class{WithWindow=e=>e(window);Alert=e=>{window.alert(e)};OnLoad(e){const t=new FontFace("PixelMicro",`url("${a}")`);t.load().then((()=>{document.fonts.add(t),e()})).catch((()=>{this.Alert("Failed to load PixelMicro font."),e()}))}PerformanceNow=()=>window.performance.now();SetInterval=(e,t)=>window.setInterval(e,t);RequestAnimationFrame=e=>window.requestAnimationFrame(e);FetchText=async e=>(await window.fetch(e)).text();FetchBinary=async e=>(await window.fetch(e)).blob();SaveFile=async(e,t)=>{};ProcessExit=e=>{}}:new class{WithWindow=e=>{};Alert=e=>{throw console.log(e),new Error(e)};OnLoad(e){e()}PerformanceNow=()=>n.now();SetInterval=(e,t)=>{for(let i=0;i<1e7;i++)e();return 0};RequestAnimationFrame=e=>{for(let t=0;t<1e7;t++)e(0);return 0};FetchText=async e=>{const{readFile:t}=await s((async()=>{const{readFile:e}=await Promise.resolve().then((()=>Ts));return{readFile:e}}),void 0);return(await t(e)).toString()};FetchBinary=async e=>{const{readFile:t}=await s((async()=>{const{readFile:e}=await Promise.resolve().then((()=>Ts));return{readFile:e}}),void 0);let i;try{i=await t(e)}catch(n){i=await t("."+e)}return i};SaveFile=async(e,t)=>{const{writeFile:i}=await s((async()=>{const{writeFile:e}=await Promise.resolve().then((()=>Ts));return{writeFile:e}}),void 0);i(e,t,(e=>{if(e)throw e;console.log("File saved.")}))};ProcessExit=e=>{"undefined"!=typeof process?process.exit(e):Deno.exit(e)}};class r{name;fullscreen;tooltip;constructor({name:e}){this.name=e,this.tooltip=null}Init=async e=>{this.fullscreen=e?.fullscreen,this.tooltip=this.createCursorTooltip()};destroy=()=>{this.removeCursorTooltip()};createCursorTooltip=()=>o.WithWindow((e=>{const t=e.document,i=t.createElement("div");return i.id="tooltip",t.body.appendChild(i),i.style.position="absolute",i.style.fontSize="13px",i.style.display="none",i.style.backgroundColor="#333",i.style.color="#fff",i.style.zIndex="3",t.addEventListener("mousemove",this.updateTooltip),t.addEventListener("mouseleave",this.hideTooltip),i}));updateTooltip=e=>{const t=this.fullscreen.scale,i=e.clientX,s=e.clientY;this.tooltip&&(this.tooltip.style.display="block",this.tooltip.style.left=(i+5)/t+"px",this.tooltip.style.top=(s+5)/t+"px",this.tooltip.textContent=`X: ${Math.round(i/t)}, Y: ${Math.round(s/t)}`)};hideTooltip=()=>{this.tooltip&&(this.tooltip.style.display="none")};removeCursorTooltip=()=>{o.WithWindow((e=>{const t=e.document;t.removeEventListener("mousemove",this.updateTooltip),t.removeEventListener("mouseleave",this.hideTooltip),this.tooltip?.parentNode&&(this.tooltip.parentNode.removeChild(this.tooltip),this.tooltip=null)}))}}var l=(e=>(e.addPoints="addPoints",e.wait="wait",e.waitNextFrame="waitNextFrame",e.waitUntilFrameNr="wait_util_frame_nr",e.repeat="repeat",e.shootDirection="shootDirection",e.shootTowardPlayer="shoot_toward_player",e.shoot_beside_player="shoot_beside_player",e.shootAccordingToMoveDirection="shootAccordingToMoveDirection",e.setShotSpeed="setShotSpeed",e.move="move",e.moveDelta="moveDelta",e.moveToAbsolute="moveToAbsolute",e.set_position="set_position",e.setSpeed="setSpeed",e.rotate_around_absolute_point="rotate_around_absolute_point",e.rotate_around_relative_point="rotate_around_relative_point",e.parallelRace="parallelRace",e.parallelAll="parallelAll",e.rotate_towards_player="rotate_towards_player",e.move_according_to_speed_and_direction="move_according_to_speed_and_direction",e.spawn="spawn",e.mirrorX="mirrorX",e.mirrorY="mirrorY",e.do="do",e.despawn="despawn",e.waitTilOutsideScreen="waitTilOutsideScreen",e.waitTilInsideScreen="waitTilInsideScreen",e.fork="fork",e.setMoveDirection="setMoveDirection",e.waitForInput="waitForInput",e.finishLevel="finishLevel",e.waitUntilCollision="waitUntilCollision",e.setAttribute="setAttribute",e.attrIf="attrIf",e.incr="incr",e.decr="decr",e.waitUntilAttrIs="waitUntilAttrIs",e.gfxSetPosition="gfxSetPosition",e.gfxSetDiameter="gfxSetDiameter",e.gfxSetColor="gfxSetColor",e.gfxSetShape="gfxSetShape",e.gfxSetRotation="gfxSetRotation",e.gfxSetScale="gfxSetScale",e.gfxScrollBg="gfxScrollBg",e.gfxFillScreen="gfxFillScreen",e.gfxAskForElement="gfxAskForElement",e.gfxRelease="gfxRelease",e.log="log",e))(l||{});class p{radians;constructor(e){for(;e<0;)e+=2*Math.PI;for(;e>=2*Math.PI;)e-=2*Math.PI;this.radians=e}static fromRadians(e){return new p(e)}static fromDegrees(e){const t=e*(Math.PI/180);return new p(t)}get degrees(){return this.radians*(180/Math.PI)}add(e){return p.fromRadians(this.radians+e.radians)}subtract(e){return p.fromRadians(this.radians-e.radians)}invert(){return p.fromRadians(-this.radians)}}class h{x;y;constructor(e,t){this.x=e,this.y=t}static fromTo(e,t){const i=t.x-e.x,s=t.y-e.y;return new h(i,s)}get length(){return(this.x**2+this.y**2)**.5}rotateClockwise(e){const t=this.x,i=this.y,s=e.radians,n=Math.cos(s)*t-Math.sin(s)*i,a=Math.sin(s)*t+Math.cos(s)*i;return new h(n,a)}rotateClockwiseAroundVector(e,t){return this.subtract(t).rotateClockwise(e).add(t)}setLength(e){if(0===this.length)return console.warn("Trying to set length of a vector with zero length"),new h(0,e);const t=e/this.length,i=this.x*t,s=this.y*t;return new h(i,s)}dot(e){return this.x*e.x+this.y*e.y}inSameDirection=e=>this.dot(e)>0;projectOn(e){const t=this.dot(e)/e.length;return e.setLength(t)}add(e){return new h(this.x+e.x,this.y+e.y)}subtract(e){return new h(this.x-e.x,this.y-e.y)}scale(e){const t=this.x*e,i=this.y*e;return new h(t,i)}get angle(){return p.fromRadians(Math.atan2(this.y,this.x)+Math.PI/2)}antiClockwiseAngleTo=e=>p.fromRadians(e.angle.radians-this.angle.radians);leftOf=e=>e.antiClockwiseAngleTo(this).degrees<180;static sum(e){const t={x:0,y:0};for(const i of e)t.x+=i.x,t.y+=i.y;return new h(t.x,t.y)}static merge(e){return h.sum(e).scale(1/e.length)}merge(e,t){return this.scale(1-t).add(e.scale(t))}clone=()=>new h(this.x,this.y);rotateClockwiseM(e){const t=this.x,i=this.y,s=e.radians;return this.x=Math.cos(s)*t-Math.sin(s)*i,this.y=Math.sin(s)*t+Math.cos(s)*i,this}}const c=function*({makeGenerator:e,times:t}){for(let i=0;i<t;i++)yield*e()},d=function*(e){let t=e.map((e=>e.next()));for(;!t.some((e=>e.done));)yield,t=e.map((e=>e.next()))},m=function*(e){let t=e.map((e=>e.next()));for(;!t.every((e=>e.done));)yield,t=e.map((e=>e.next()))};function u({attrValue:e,condition:t,value:i}){switch(t){case"equals":return e===i;case"greaterThan":return e>i;case"lessThan":return e<i;case"greaterThanOrEqual":return e>=i;case"lessThanOrEqual":return e<=i;default:throw new Error(`Unknown condition: ${t}`)}}const y=357,g=240,f=1e3/60,v="2",b=e=>{const t=-e,i=y+e,s=-e,n=g+e;return({x:e,y:a})=>e<t||e>i||a<s||a>n},x=function*(e,t,i){const s=e.degrees/e.frames;for(let n=1;n<=e.frames;n++){const e=s*(n-1),a=s*n,o=t.rotateClockwise(p.fromDegrees(e)),r=t.rotateClockwise(p.fromDegrees(a)),c=h.fromTo(o,r);i({type:l.moveDelta,x:c.x,y:c.y}),yield}};class w{input;gamepad;actionHandler;enemy;attrs;pseudoRandom;generators;constructor(e){const{actions:t,actionHandler:i,enemy:s,input:n,gamepad:a}=e;this.actionHandler=i,this.enemy=s,this.attrs=s.enemies.attributes,this.pseudoRandom=s.enemies.pseudoRandom,this.input=n,this.gamepad=a,this.generators=[this.makeGenerator(t)]}ExecuteOneAction=e=>{const t=this.makeGenerator([e]),{done:i}=t.next();return!!i};ProgressOneFrame(){const e=this.generators.length,t=this.generators.map((e=>e.next()));return!!this.enemy.despawned||e===this.generators.length&&t.every((e=>e.done))}leftPressed=()=>this.input.ButtonsPressed.left||this.gamepad.left;rightPressed=()=>this.input.ButtonsPressed.right||this.gamepad.right;upPressed=()=>this.input.ButtonsPressed.up||this.gamepad.up;downPressed=()=>this.input.ButtonsPressed.down||this.gamepad.down;shootPressed=()=>this.input.ButtonsPressed.shoot||this.gamepad.shoot;laserPressed=()=>this.input.ButtonsPressed.laser||this.gamepad.laser;startPressed=()=>this.input.ButtonsPressed.start;getAttribute=e=>this.attrs.getAttribute({gameObjectId:e.gameObjectId??this.enemy.id,attribute:e.attribute});getNumber=e=>"number"==typeof e?e:"attr"in e?this.attrs.getNumber({gameObjectId:e.gameObjectId??this.enemy.id,attribute:e.attr}):this.pseudoRandom.randomInt(e.min,e.max);getString=e=>"string"==typeof e?e:this.attrs.getString({gameObjectId:e.gameObjectId??this.enemy.id,attribute:e.attr});isButtonPressed=e=>{switch(e){case"left":return this.leftPressed();case"right":return this.rightPressed();case"up":return this.upPressed();case"down":return this.downPressed();case"shoot":return this.shootPressed();case"laser":return this.laserPressed();case"start":return this.startPressed()}};*makeGenerator(e=[]){let t=0;const i=e.length;for(;t<i;){const i=e[t];switch(i.type){case l.waitForInput:{const e=i.pressed,t=i.notPressed??[];for(;!e.every(this.isButtonPressed)||t.some(this.isButtonPressed);)yield;break}case l.waitUntilAttrIs:{const{gameObjectId:e,attr:t,is:s}=i;for(;this.getAttribute({gameObjectId:e?this.getString(e):void 0,attribute:t})!==s;)yield;break}case l.waitUntilCollision:{const{collisionTypes:e}=i;for(;!this.enemy.collidedWithCollisionTypesThisFrame.some((t=>e.includes(t)));)yield;break}case l.setAttribute:{const{gameObjectId:e,attribute:t,value:s}=i;"object"==typeof s&&"min"in s?this.attrs.setAttribute({gameObjectId:e??this.enemy.id,attribute:t,value:this.pseudoRandom.randomInt(s.min,s.max)}):this.attrs.setAttribute({gameObjectId:e??this.enemy.id,attribute:t,value:s});break}case l.fork:{const e=this.makeGenerator(i.actions);this.generators.splice(this.generators.length-1,0,e),e.next();break}case l.parallelRace:{const e=i.actionsLists.map((e=>this.makeGenerator(e)));yield*d(e);break}case l.parallelAll:{const e=i.actionsLists.map((e=>this.makeGenerator(e)));yield*m(e);break}case l.repeat:{const e=this.getNumber(i.times);yield*c({makeGenerator:()=>this.makeGenerator(i.actions),times:e});break}case l.attrIf:{const{attrName:e,condition:t,gameObjectId:s,value:n,yes:a,no:o}=i,r=u({attrValue:this.getAttribute({gameObjectId:s,attribute:e}),condition:t,value:n});yield*this.makeGenerator(r?a:o);break}case l.waitNextFrame:yield;break;case l.wait:for(let e=0;e<this.getNumber(i.frames);e++)yield;break;case l.waitTilInsideScreen:{const e=b(0);for(;e(this.enemy.getPosition());)yield;break}case l.waitTilOutsideScreen:{const{margin:e=30}=i,t=b(e);for(;!t(this.enemy.getPosition());)yield;break}case l.move:{const e=void 0!==i.x?this.getNumber(i.x):0,t=void 0!==i.y?this.getNumber(i.y):0,s=e/i.frames,n=t/i.frames;for(let a=1;a<=i.frames;a++)this.actionHandler({type:l.moveDelta,x:s,y:n}),yield;break}case l.moveToAbsolute:{const e=this.enemy.getPosition(),{moveTo:t}=i,s=void 0!==t.x?t.x-e.x:0,n=void 0!==t.y?t.y-e.y:0,a=s/i.frames,o=n/i.frames;for(let r=1;r<=i.frames;r++)this.actionHandler({type:l.moveDelta,x:a,y:o}),yield;break}case l.rotate_around_relative_point:{const e=i.point.x??0,t=i.point.y??0,s=new h(-e,-t);yield*x(i,s,this.actionHandler);break}case l.rotate_around_absolute_point:{const e=this.enemy.getPosition(),t=i.point.x??e.x,s=i.point.y??e.y,n=h.fromTo(new h(t,s),new h(e.x,e.y));yield*x(i,n,this.actionHandler);break}case l.log:console.log(`LogAction: ${i.msg}`);break;default:this.actionHandler(i)}t++}}}class S{vector;constructor(e){const t=e.length;if(0===t)return void(this.vector=new h(0,1));const i=1/t,s=e.x*i,n=e.y*i;this.vector=new h(s,n)}get x(){return this.vector.x}get y(){return this.vector.y}rotateClockwise(e){const t=this.vector.x,i=this.vector.y,s=e.radians,n=Math.cos(s)*t-Math.sin(s)*i,a=Math.sin(s)*t+Math.cos(s)*i;return new S(new h(n,a))}toVector(){return new h(this.vector.x,this.vector.y)}static merge(e){const t=e.map((e=>e.toVector())),i=h.sum(t);return new S(i)}static normalFromPositions=(e,t)=>{const i=h.fromTo(e,t);return new S(i).rotateClockwise(p.fromDegrees(90))};toVectorM(){return this.vector}}const I={},A=e=>{const t=I[e]||0,i=t+1;return I[e]=i,t},T=e=>"object"==typeof e,E=e=>"number"==typeof e,D=e=>"object"==typeof e&&null!==e&&"min"in e,k=e=>{if(!E(e)){const t=`assertNumber: ${JSON.stringify(e)} is not of type "number"`;throw o.Alert(t),new Error(t)}return e},C=e=>{if(!(e=>"string"==typeof e)(e)){const t=`assertString: ${JSON.stringify(e)} is not of type "string"`;throw o.Alert(t),new Error(t)}return e};class F{graphics;gfxHandle;constructor(e){const{graphics:t,x:i,y:s,diameter:n}=e;this.graphics=t,this.gfxHandle=this.graphics.Dispatch({type:l.gfxAskForElement}).handle,this.graphics.Dispatch({type:l.gfxSetPosition,handle:this.gfxHandle,x:i,y:s}),this.graphics.Dispatch({type:l.gfxSetDiameter,handle:this.gfxHandle,diameter:n}),this.graphics.Dispatch({type:l.gfxSetColor,handle:this.gfxHandle,color:"red"}),this.graphics.Dispatch({type:l.gfxSetShape,handle:this.gfxHandle,shape:"diamondShield"})}setPosition=({x:e,y:t})=>{this.graphics.Dispatch({type:l.gfxSetPosition,handle:this.gfxHandle,x:e,y:t})};release=()=>{this.graphics.Dispatch({type:l.gfxRelease,handle:this.gfxHandle})};setRotation=({degrees:e})=>{this.graphics.Dispatch({type:l.gfxSetRotation,handle:this.gfxHandle,degrees:e})};dispatch=e=>{switch(e.type){case l.gfxSetColor:case l.gfxSetDiameter:case l.gfxSetPosition:case l.gfxSetRotation:case l.gfxSetShape:case l.gfxSetScale:case l.gfxScrollBg:case l.gfxFillScreen:this.graphics.Dispatch({...e,handle:this.gfxHandle});break;default:o.Alert(`${e.type} not handled in EnemyGfx.dispatch!\nThe full offending action:\n${JSON.stringify(e,null,2)}`)}}}class P{id;enemies;graphics;shotSpeed=.2;mirrorX=!1;mirrorY=!1;actionExecutor;gfx;name;collidedWithCollisionTypesThisFrame=[];despawned=!1;constructor(e,t,i){this.enemies=e,this.id=`${i.name}-${A(i.name)}`,this.name=i.name,this.attrs.setAttribute({gameObjectId:this.id,attribute:"diameter",value:i.diameter}),this.x=t.x,this.y=t.y,this.actionExecutor=new w({actionHandler:this.HandleAction,actions:i.actions,enemy:this,input:this.enemies.input,gamepad:this.enemies.gamepad}),this.attrs.setAttribute({gameObjectId:this.id,attribute:"collisionType",value:"none"}),this.attrs.setAttribute({gameObjectId:this.id,attribute:"moveDirectionAngle",value:180}),this.speed=0,this.graphics=this.enemies.graphics,this.gfx=new F({diameter:i.diameter,graphics:this.graphics,x:t.x,y:t.y})}get attrs(){return this.enemies.attributes}get moveDirection(){const e=k(this.attrs.getAttribute({gameObjectId:this.id,attribute:"moveDirectionAngle"}));return new S(new h(0,-1)).rotateClockwise(p.fromDegrees(e))}set moveDirection(e){const t=e.toVector().angle.degrees;this.attrs.setAttribute({gameObjectId:this.id,attribute:"moveDirectionAngle",value:t})}get diameter(){return k(this.attrs.getAttribute({gameObjectId:this.id,attribute:"diameter"}))}get speed(){return k(this.attrs.getAttribute({gameObjectId:this.id,attribute:"speed"}))}set speed(e){this.attrs.setAttribute({gameObjectId:this.id,attribute:"speed",value:e})}get x(){return this.attrs.getNumber({gameObjectId:this.id,attribute:"x"})}set x(e){this.attrs.setAttribute({gameObjectId:this.id,attribute:"x",value:e})}get y(){return this.attrs.getNumber({gameObjectId:this.id,attribute:"y"})}set y(e){this.attrs.setAttribute({gameObjectId:this.id,attribute:"y",value:e})}get Radius(){return this.diameter/2}OnFrameTick=()=>{this.actionExecutor.ProgressOneFrame()||(this.attrs.getAttribute({gameObjectId:this.id,attribute:"boundToWindow"})&&this.boundToWindow(),this.gfx?.setPosition({x:this.x,y:this.y}),this.gfx?.setRotation({degrees:this.moveDirection.toVector().angle.degrees}),this.collidedWithCollisionTypesThisFrame=[])};boundToWindow=()=>{const e=this.diameter/2,t=this.x,i=this.y;t<e?this.x=e:t>y-e&&(this.x=y-e),i<e?this.y=e:i>g-e&&(this.y=g-e)};despawn=()=>{this.despawned=!0,delete this.enemies.enemies[this.id];const e=k(this.attrs.getAttribute({gameObjectId:this.id,attribute:"pointsOnDeath"}));0!==e&&this.enemies.eventsPoints.dispatchEvent({type:"add_points",enemy:this.name,points:e}),this.gfx&&(this.gfx.release(),this.gfx=void 0),this.attrs.removeGameObject(this.id);for(const t of this.actionExecutor.generators)t.next=()=>({value:void 0,done:!0});this.actionExecutor.generators=[]};HandleAction=e=>{switch(e.type){case l.shootAccordingToMoveDirection:this.shootAccordingToMoveDirection(e.shot);break;case l.shootDirection:this.ShootDirection({dirX:e.x,dirY:e.y});break;case l.setSpeed:this.speed=e.pixelsPerFrame;break;case l.setShotSpeed:this.shotSpeed=e.pixelsPerFrame;break;case l.set_position:this.SetPosition({x:e.x,y:e.y});break;case l.shootTowardPlayer:this.ShootTowardPlayer();break;case l.shoot_beside_player:this.ShootBesidePlayer(e.degrees);break;case l.rotate_towards_player:this.RotateTowardsPlayer();break;case l.setMoveDirection:this.setMoveDirection(e.degrees);break;case l.move_according_to_speed_and_direction:this.moveAccordingToSpeedAndDirection();break;case l.spawn:{const{enemy:t,actions:i,x:s,y:n}=e,a=D(s)?this.enemies.pseudoRandom.randomInt(s.min,s.max):s??0,o=D(n)?this.enemies.pseudoRandom.randomInt(n.min,n.max):n??0;this.spawn({enemy:t,pos:{x:a,y:o},actions:i});break}case l.mirrorX:this.mirrorX=e.value;break;case l.mirrorY:this.mirrorY=e.value;break;case l.moveDelta:this.moveDelta({x:e.x,y:e.y});break;case l.despawn:this.despawn();break;case l.incr:{const{gameObjectId:t,attribute:i,amount:s=1}=e;this.attrs.incr({gameObjectId:t??this.id,attribute:i,amount:s});break}case l.decr:{const{gameObjectId:t,attribute:i,amount:s=1}=e;this.attrs.decr({gameObjectId:t??this.id,attribute:i,amount:s});break}case l.finishLevel:this.enemies.events.dispatchEvent({type:"gameOver"});break;case l.addPoints:this.enemies.eventsPoints.dispatchEvent({type:"add_points",enemy:this.name,points:e.points});break;default:this.gfx?.dispatch(e)}};moveDelta=({x:e=0,y:t=0})=>{this.x=this.mirrorX?this.x-e:this.x+e,this.y=this.mirrorY?this.y-t:this.y+t};ShootDirection=e=>{const{dirX:t,dirY:i,shot:s="shot"}=e,n=0===t&&0===i,a=this.shotSpeed/(n?9999:Math.hypot(t,i));this.spawn({enemy:s,pos:{x:0,y:0},actions:[{type:l.fork,actions:[{type:l.repeat,times:99999,actions:[{type:l.moveDelta,x:t*a,y:i*a},{type:l.waitNextFrame}]}]}]})};ShootTowardPlayer=()=>{const e=this.enemies.player,t=e.x-this.x,i=e.y-this.y;this.ShootDirection({dirX:t,dirY:i})};ShootBesidePlayer=e=>{const t=this.enemies.player,i=t.x-this.x,s=t.y-this.y,n=new h(i,s).rotateClockwiseM(p.fromDegrees(e));this.ShootDirection({dirX:n.x,dirY:n.y})};shootAccordingToMoveDirection=e=>{const t=this.moveDirection;this.ShootDirection({dirX:t.x,dirY:t.y,shot:e})};SetPosition=({x:e,y:t})=>{const i=this.getPosition(),s=new h(i.x,i.y),n=new h(e,t),a=h.fromTo(s,n);let o=a.x,r=a.y;this.mirrorX&&(o=-o),this.mirrorY&&(r=-r);const l=this.x+o,p=this.y+r;this.x=l,this.y=p};RotateTowardsPlayer=()=>{const e=this.enemies.player,t=new h(e.x,e.y),i=new h(this.x,this.y),s=h.fromTo(i,t);this.moveDirection=new S(s)};setMoveDirection=e=>{const t=new S(new h(0,-1)).rotateClockwise(p.fromDegrees(e));this.moveDirection=t};moveAccordingToSpeedAndDirection=()=>{const e=this.speed,t=this.x+this.moveDirection.x*e,i=this.y+=this.moveDirection.y*e;this.x=t,this.y=i};spawn=({enemy:e,pos:t,actions:i})=>{const s={x:t.x+this.x,y:t.y+this.y};this.enemies.Spawn({enemy:e,position:s,prependActions:i,parentId:this.id})};getPosition=()=>{let e=this.x,t=this.y;return this.mirrorX&&(e=y-e),this.mirrorY&&(t=g-t),{x:e,y:t}}}class _{name;enemies;memoizedPlayer;gameData;events;eventsCollisions;eventsPoints;graphics;input;gamepad;settings;attributes;pseudoRandom;constructor({name:e}){this.name=e,this.enemies={}}Init=async e=>{this.events=e?.events,this.eventsCollisions=e?.eventsCollisions,this.eventsPoints=e?.eventsPoints,this.gameData=e?.gameData,this.graphics=e?.graphics,this.input=e?.input,this.gamepad=e?.gamepad,this.settings=e?.settings,this.attributes=e?.attributes,this.pseudoRandom=e?.pseudoRandom,this.events.subscribeToEvent(this.name,this.handleEvent),this.eventsCollisions.subscribeToEvent(this.name,this.handleEvent)};Spawn=({enemy:e,position:t,prependActions:i=[],parentId:s})=>{const n=this.gameData.GetEnemy(e),a=s?[{type:l.setAttribute,attribute:"parentId",value:s}]:[],o={...n,actions:[...a,...i,...n.actions]},r=new P(this,t,o);this.enemies[r.id]=r,r.OnFrameTick()};get player(){if(void 0!==this.memoizedPlayer)return this.memoizedPlayer;const e=Object.values(this.enemies).find((e=>"player"===this.attributes.getAttribute({gameObjectId:e.id,attribute:"collisionType"})));if(void 0===e)throw new Error("Enemies.getPlayer: Player was not found");return this.memoizedPlayer=e,e}handleEvent=e=>{switch(e.type){case"frame_tick":1===e.frameNr&&this.Spawn({enemy:"spawner",position:{x:0,y:0}});for(const e of Object.values(this.enemies))e.OnFrameTick();break;case"collisions":for(const[t,i]of Object.entries(e.collisions)){const e=this.enemies[t];e&&(e.collidedWithCollisionTypesThisFrame=[...new Set([...e.collidedWithCollisionTypesThisFrame,...i])])}}}}const O=e=>`${e}px`;class M{app;name;startTime;framCounterDiv;elapsedTimeDiv;fpsDiv;maxWebWorkers;constructor({app:e,name:t}){this.name=t,this.startTime=null,this.app=e,this.framCounterDiv=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.top=O(g),t.style.left="5px",t.style.zIndex=v,e.document.body.appendChild(t),t})),this.elapsedTimeDiv=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.top=O(g),t.style.left="75px",t.style.zIndex=v,e.document.body.appendChild(t),t})),this.fpsDiv=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.top=O(g),t.style.left="155px",t.style.zIndex=v,e.document.body.appendChild(t),t})),this.maxWebWorkers=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.top=O(g),t.style.left="223px",t.style.zIndex=v,e.document.body.appendChild(t),t}))}Init=async()=>{this.app.events.subscribeToEvent(this.name,this.handleEvent),this.elapsedTimeDiv&&(this.elapsedTimeDiv.innerHTML="elapsed: 0s"),this.framCounterDiv&&(this.framCounterDiv.innerHTML="frames: 0"),this.fpsDiv&&(this.fpsDiv.innerHTML="fps: 0"),o.WithWindow((e=>{const t=e.navigator.hardwareConcurrency;this.maxWebWorkers&&(this.maxWebWorkers.innerHTML=`maxWebWorkers: ${t}`)}))};destroy=()=>{this.app.events.unsubscribeToEvent(this.name),this.startTime=null,this.framCounterDiv?.remove(),this.framCounterDiv=void 0,this.elapsedTimeDiv?.remove(),this.elapsedTimeDiv=void 0,this.fpsDiv?.remove(),this.fpsDiv=void 0,this.maxWebWorkers?.remove(),this.maxWebWorkers=void 0};handleEvent=e=>{if("frame_tick"!==e.type)return;null===this.startTime&&(this.startTime=o.PerformanceNow());const t=o.PerformanceNow()-this.startTime,i=e.frameNr;this.elapsedTimeDiv&&(this.elapsedTimeDiv.innerHTML=`elapsed: ${((e,t=1)=>Math.round(e*10**t)/10**t)(t/1e3)}s`),this.framCounterDiv&&(this.framCounterDiv.innerHTML=`frames: ${i}`),this.fpsDiv&&(this.fpsDiv.innerHTML=`fps: ${Math.round(i/(t/1e3))}`)}}class W{events;name;history;buttonsPressed={start:!1,shoot:!1,laser:!1,left:!1,right:!1,up:!1,down:!1};onKeyUpCallback;frameCount=0;constructor({name:e}){this.name=e,this.history={inputs:{},score:0},o.WithWindow((e=>{e.document.onkeydown=this.handleKeyDown,e.document.onkeyup=this.handleKeyUp}))}Init=async e=>{this.events=e?.events,this.events.subscribeToEvent(this.name,(e=>{switch(e.type){case"frame_tick":this.frameCount=e.frameNr;break;case"gameOver":console.log("Input.history:"),console.log(this.history)}}))};get ButtonsPressed(){const e=this.frameCount,t={...this.buttonsPressed};if(Object.values(t).includes(!0)){for(const e of Object.keys(t))"laser"!==e&&"shoot"!==e&&"up"!==e&&"down"!==e&&"left"!==e&&"right"!==e&&"start"!==e||!1===t[e]&&delete t[e];this.history.inputs[e]=t}return this.buttonsPressed}handleKey=(e,t)=>{switch(e.keyCode){case 13:return this.buttonsPressed.start=t,"start";case 32:return this.buttonsPressed.shoot=t,"shoot";case 17:return this.buttonsPressed.laser=t,"laser";case 37:return this.buttonsPressed.left=t,"left";case 38:return this.buttonsPressed.up=t,"up";case 39:return this.buttonsPressed.right=t,"right";case 40:return this.buttonsPressed.down=t,"down";default:return}};handleKeyDown=e=>{this.handleKey(e,!0)};handleKeyUp=e=>{const t=this.handleKey(e,!1);void 0!==t&&this.onKeyUpCallback?.(t)}}class U{name;constructor(e){this.name=e.name,o.WithWindow((e=>{e.addEventListener("gamepadconnected",(function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)}))}))}Init=async()=>{};get shoot(){return this.getPressedButton(0)}get laser(){return this.getPressedButton(1)}get left(){return this.getPressedButton(14)}get right(){return this.getPressedButton(15)}get up(){return this.getPressedButton(12)}get down(){return this.getPressedButton(13)}getPressedButton=t=>!!e()&&o.WithWindow((e=>{const i=e.navigator.getGamepads();if(i.length<1)return!1;const s=i[0];return!!s&&!!s.buttons[t]?.pressed}))}class G{name;accumulatedTime=0;events;eventsCollisions;enemies;attributes;constructor(e){this.name=e.name}Init=async e=>{this.events=e?.events,this.eventsCollisions=e?.eventsCollisions,this.enemies=e?.enemies,this.attributes=e?.attributes,this.events.subscribeToEvent(this.name,(({type:e})=>{"frame_tick"===e&&this.update()}))};update=()=>{const e=o.PerformanceNow(),t={},i=Object.values(this.enemies.enemies).filter((e=>"none"!==this.attributes.getAttribute({gameObjectId:e.id,attribute:"collisionType"})));for(const n of i){t[n.id]=[];for(const e of i)if(n.id!==e.id&&this.calcCollision({doesThis:n,collideWithThis:e})){const i=C(this.attributes.getAttribute({gameObjectId:e.id,attribute:"collisionType"}));t[n.id]=[...new Set([...t[n.id],i])]}}const s=o.PerformanceNow();this.accumulatedTime+=s-e,Object.keys(t).length>0&&this.eventsCollisions.dispatchEvent({type:"collisions",collisions:t})};calcCollision=e=>{const{doesThis:t,collideWithThis:i}=e,s=.9*(t.Radius+i.Radius),n=t.x-i.x,a=t.y-i.y;return Math.hypot(n,a)<=s}}class L{app;name;subscribers;constructor({app:e,name:t}){this.app=e,this.name=t,this.subscribers={}}Init=async()=>{};subscribeToEvent=(e,t)=>{this.subscribers[e]=t};unsubscribeToEvent=e=>{delete this.subscribers[e]};dispatchEvent=e=>{for(const t of Object.values(this.subscribers))t(e)}}const j={largest:45,large:40,normal:30,small:27,smaller:23,smallest:18};class B{element;constructor(e){const{text:t,onClick:i=null,fontSize:s=j.smallest,left:n=0,top:a=0,padding:r="3px 5px"}=e;this.element=o.WithWindow((e=>{const o=e.document.createElement("button");return o.style.position="fixed",o.style.top=O(a),o.style.left=O(n),o.style.fontSize=O(s),o.style.whiteSpace="pre",o.style.padding=r,o.style.zIndex=v,o.innerHTML=t,o.onclick=i,e.document.body.appendChild(o),o}))}destroy=()=>{this.element.remove()}}class N{destroyables=[];add=e=>{this.destroyables.push(e)};destroy=()=>{0===this.destroyables.length&&console.warn("Destroyable.destroy: no IDestroyable:s to destroy since this.destroyables is empty.");for(const e of this.destroyables)e.destroy()}}class R{name;destroyables;gameLoop;settings;constructor({name:e}){this.name=e,this.destroyables=new N}createIncrFrameButton=e=>{const{frames:t,left:i}=e,s=new B({text:`+${t}`,left:i,top:295,onClick:()=>{for(let e=0;e<t;e++)this.gameLoop.nextFrame()}});this.destroyables.add(s)};createFrameMultiplierButton=e=>{const{multiplier:t,left:i}=e,s=new B({text:`${t}x`,left:i,top:319,onClick:()=>{this.gameLoop.frameSpeedMultiplier=t}});this.destroyables.add(s)};Init=async e=>{this.gameLoop=e?.gameLoop,this.settings=e?.settings,this.render()};destroy=()=>{this.destroyables.destroy()};render=()=>{this.createIncrFrameButton({left:5,frames:1}),this.createIncrFrameButton({left:31,frames:2}),this.createIncrFrameButton({left:57,frames:5}),this.createIncrFrameButton({left:83,frames:10}),this.createIncrFrameButton({left:115,frames:100}),this.createFrameMultiplierButton({left:5,multiplier:0}),this.createFrameMultiplierButton({left:32,multiplier:1}),this.createFrameMultiplierButton({left:59,multiplier:2}),this.createFrameMultiplierButton({left:86,multiplier:3}),this.createFrameMultiplierButton({left:113,multiplier:4}),this.createFrameMultiplierButton({left:140,multiplier:5});const{skipStartMenu:e}=this.settings.settings;this.destroyables.add(new B({text:e?"unskip start menu":"skip start menu",left:5,top:270,onClick:()=>{this.settings.toggleSetting("skipStartMenu"),this.refresh()}}))};refresh=()=>{this.destroy(),this.render()}}class ${app;name;points;constructor({app:e,name:t}){this.app=e,this.name=t,this.points=0}Init=async()=>{this.app.events.subscribeToEvent(this.name,this.onEvent),this.app.eventsPoints.subscribeToEvent(this.name,this.onEvent)};onEvent=e=>{switch(e.type){case"add_points":this.points+=e.points,this.updatePoints();break;case"gameOver":this.app.events.unsubscribeToEvent(this.name)}};updatePoints=()=>{this.app.eventsUi.dispatchEvent({type:"uiScoreUpdated",points:this.points})}}const H="__highscore";let z=class{name;highscores;gameData;constructor({name:e,highscores:t}){this.name=e,this.highscores={version:2,games:[this.defaultHighscore(),this.defaultHighscore(),this.defaultHighscore(),this.defaultHighscore()]},t&&(this.highscores=t)}Init=async e=>{this.gameData=e?.gameData,o.WithWindow((e=>{const t=e.localStorage.getItem(H);if(t){const e=JSON.parse(t);T(e)&&2===e.version&&(this.highscores=e)}else e.localStorage.setItem(H,JSON.stringify(this.highscores))}))};getTop1=()=>this.highscore[0];getTop10=()=>this.highscore;qualifiedForTop10=e=>{let t,i=!1;for(let s=0;s<10;s++)if(e>this.highscore[s].score){i=!0,t=s;break}return{qualifiedForTop10:i,rank:t}};registerNewEntry=e=>{e.score=Math.round(e.score);const{rank:t}=this.qualifiedForTop10(e.score);if(void 0===t)return;let i=this.highscore;i.splice(t,0,e),i=i.filter(((e,t)=>t<10)),this.highscores.games[this.gameData.getAndAssertActiveGame()]=i,o.WithWindow((e=>{e.localStorage.setItem(H,JSON.stringify(this.highscores))}))};defaultHighscore=()=>Array(10).fill(0).map((()=>({name:"_____",score:0})));get highscore(){const e=this.highscores.games[this.gameData.getAndAssertActiveGame()];if(void 0===e)throw new Error("Highscore.highscore: failed to get highscore.");return e.slice()}};function q(e,{condition:t="equals",value:i,yes:s,no:n}){return{condition:t,type:l.attrIf,attrName:e,value:i,yes:s,no:n}}function X(...e){return{type:l.repeat,times:1e8,actions:e}}function Y(...e){return{type:l.fork,actions:e}}const V=({x:e,y:t,frames:i})=>({type:l.moveToAbsolute,moveTo:{x:e,y:t},frames:i}),K=(...e)=>({type:l.parallelAll,actionsLists:e.map((e=>Array.isArray(e)?e:[e]))});function J(...e){return{type:l.parallelRace,actionsLists:e.map((e=>Array.isArray(e)?e:[e]))}}const Q=(e,t)=>({type:l.repeat,times:e,actions:t}),Z=e=>({type:l.setSpeed,pixelsPerFrame:e}),ee=(e,t)=>({type:l.spawn,enemy:e,x:t?.x,y:t?.y,actions:t?.actions}),te=e=>({type:l.setShotSpeed,pixelsPerFrame:e}),ie=(...e)=>Q(2,e),se=e=>({type:l.wait,frames:e});function ne(e){const t=e.options?.despawnWhenOutsideScreen??!0,i=e.options?.despawnMargin,s=e.options?.defaultDirectionalControls?[Y(X({type:l.waitForInput,pressed:["left"],notPressed:["up","down"]},{type:l.moveDelta,x:-2.35},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["right"],notPressed:["up","down"]},{type:l.moveDelta,x:2.35},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["up"],notPressed:["left","right"]},{type:l.moveDelta,y:-2.35},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["down"],notPressed:["left","right"]},{type:l.moveDelta,y:2.35},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["up","left"]},{type:l.moveDelta,x:-2.35/Math.SQRT2,y:-2.35/Math.SQRT2},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["up","right"]},{type:l.moveDelta,x:2.35/Math.SQRT2,y:-2.35/Math.SQRT2},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["down","left"]},{type:l.moveDelta,x:-2.35/Math.SQRT2,y:2.35/Math.SQRT2},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["down","right"]},{type:l.moveDelta,x:2.35/Math.SQRT2,y:2.35/Math.SQRT2},{type:l.waitNextFrame}))]:[],n=t?[{type:l.fork,actions:[{type:l.waitTilInsideScreen},{type:l.waitTilOutsideScreen,margin:i},{type:l.despawn}]}]:[];return{name:e.name,diameter:e.diameter,actions:[{type:l.setAttribute,attribute:"pointsOnDeath",value:0},{type:l.setAttribute,attribute:"collisionType",value:"enemy"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.setAttribute,attribute:"hp",value:e.hp},{type:l.setAttribute,attribute:"maxHp",value:e.hp},...s,...n,...e.actions]}}const ae=ne({name:"explosion",diameter:18,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"explosion"},se(40),{type:l.despawn}]}),oe=ne({name:"roundExplosion",diameter:40,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"roundExplosion"},se(75),{type:l.despawn}]}),re=({moveDeltaX:e,moveDeltaY:t})=>({type:l.spawn,enemy:"playerShot",actions:[Y(X({type:l.moveDelta,x:e,y:t},{type:l.waitNextFrame}))]}),le=[re({moveDeltaX:0,moveDeltaY:-9}),re({moveDeltaX:1.5,moveDeltaY:-9}),re({moveDeltaX:-1.5,moveDeltaY:-9}),se(8)],pe=[{type:l.spawn,enemy:"playerLaser",y:15},{type:l.spawn,enemy:"playerLaser",y:10},{type:l.spawn,enemy:"playerLaser",y:5},{type:l.spawn,enemy:"playerLaser",y:0},{type:l.spawn,enemy:"playerLaser",y:-5},{type:l.spawn,enemy:"playerLaser",y:-10},se(3)],he=ne({name:"player",diameter:20,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!0},actions:[Y({type:l.waitUntilCollision,collisionTypes:["enemy","enemyBullet"]},{type:l.finishLevel},{type:l.despawn}),{type:l.gfxSetColor,color:"aqua"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"collisionType",value:"player"},{type:l.setAttribute,attribute:"boundToWindow",value:!0},{type:l.gfxSetShape,shape:"none"},se(1),{type:l.gfxSetShape,shape:"diamondShield"},Y(X({type:l.waitForInput,pressed:["shoot"],notPressed:["laser"]},...le)),Y(X({type:l.waitForInput,pressed:["laser"]},...pe))]}),ce=ne({name:"playerLaser",hp:1,diameter:5,options:{despawnMargin:5},actions:[Y({type:l.waitUntilCollision,collisionTypes:["enemy"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"playerBullet"},{type:l.setAttribute,attribute:"pointsOnDeath",value:-.2},{type:l.gfxSetShape,shape:"square"},{type:l.gfxSetColor,color:"aqua"},J(X({type:l.moveDelta,y:-30},{type:l.waitNextFrame}),[se(8),{type:l.despawn}])]}),de=ne({name:"playerShot",hp:1,diameter:5,options:{despawnMargin:5},actions:[Y({type:l.waitUntilCollision,collisionTypes:["enemy"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"playerBullet"},{type:l.setAttribute,attribute:"pointsOnDeath",value:-1},{type:l.gfxSetShape,shape:"circle"},{type:l.gfxSetColor,color:"aqua"}]}),me=ne({name:"shot",hp:1,diameter:5,options:{despawnMargin:5},actions:[Y({type:l.waitUntilCollision,collisionTypes:["player"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"enemyBullet"},{type:l.gfxSetShape,shape:"circle"}]}),ue=ne({name:"spawner",diameter:20,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[Y(se(3200),{type:l.finishLevel}),{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},ee("parallax"),ee("player",{x:178.5,y:220}),ee("stage1")]}),ye=ee("nonShootingAimer",{x:128.5,y:-22}),ge=ee("nonShootingAimer",{x:228.5,y:-22}),fe=ee("sinus",{x:75,y:-20}),ve=ee("sinus",{x:280,y:-20,actions:[{type:l.setAttribute,attribute:"right",value:!0}]}),be=ee("firstMiniboss",{x:118.881,y:-20}),xe=ee("firstMiniboss",{x:237.762,y:-20,actions:[{type:l.setAttribute,attribute:"right",value:!0}]}),we=Q(8,[ye,ge,se(40)]),Se=Q(5,[fe,se(70),ve,se(70)]),Ie=ne({name:"stage1",diameter:20,hp:9999,actions:[{type:l.setAttribute,attribute:"pointsOnDeath",value:25},{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},se(120),we,se(120),Se,se(200),be,xe]}),Ae=ne({name:"nonShootingAimer",hp:4,diameter:22,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"pointsOnDeath",value:25},Z(1.6),K(Q(26.25,[{type:l.rotate_towards_player},se(8)]),X({type:l.move_according_to_speed_and_direction},{type:l.waitNextFrame}))]}),Te={type:l.move,frames:80,x:-205,y:30},Ee={...Te,x:205},De={type:l.rotate_around_relative_point,degrees:-180,frames:35,point:{y:31}},ke={...De,degrees:180},Ce=[se(16),{type:l.shootTowardPlayer}],Fe=K(De,Ce),Pe=K(ke,Ce),_e=ne({name:"sinus",hp:3,diameter:24,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"pointsOnDeath",value:25},te(2),q("right",{value:!0,yes:[{type:l.mirrorX,value:!0}]}),ie(Fe,Ee,Pe,Te)]}),Oe={type:l.shootDirection,x:0,y:1},Me=[se(75),X(te(2.6),((...e)=>Q(3,e))(Oe,se(3)),se(55),te(2.2),ie({type:l.shootTowardPlayer},{type:l.shoot_beside_player,degrees:25},{type:l.shoot_beside_player,degrees:-25},se(64)))],We=V({x:116,y:0,frames:40}),Ue=V({y:75,frames:52}),Ge={type:l.rotate_around_relative_point,degrees:-90,frames:39,point:{x:25,y:-5}},Le={type:l.rotate_around_relative_point,degrees:90,frames:39,point:{x:-20,y:-11}},je=V({x:139.5,frames:47}),Be=V({y:11,frames:100}),Ne={type:l.rotate_around_absolute_point,point:{y:61},degrees:-180,frames:100},Re=V({x:99.5,frames:50}),$e=V({y:141,frames:30}),He=V({y:61,frames:80}),ze=V({x:138.5,y:105,frames:40}),qe={type:l.rotate_around_absolute_point,point:{x:178.5},degrees:360,frames:240},Xe={type:l.rotate_around_absolute_point,point:{x:178.5},degrees:-360,frames:240},Ye=V({x:98.5,y:290,frames:210}),Ve=[q("right",{value:!0,yes:[{type:l.mirrorX,value:!0}]}),We,Ue,Ge,se(25),Le,se(25),je,se(25),Be,se(25),Ne,se(25),Re,se(25),$e,se(25),He,se(25),ze,se(25),q("right",{value:!0,yes:[{type:l.mirrorY,value:!0}]}),qe,se(25),Xe,q("right",{value:!0,yes:[{type:l.mirrorY,value:!1}]}),se(25),Ye],Ke=ne({name:"firstMiniboss",hp:120,diameter:35,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"pointsOnDeath",value:1e3},J(Me,Ve)]}),Je={"-1":-24,0:0,1:24,2:48,3:72,4:96,5:120,6:144,7:168,8:192,9:216,10:240,11:264},Qe=ne({name:"stage2",diameter:20,hp:9999,actions:[{type:l.spawn,enemy:"cloner",x:179,y:-20},se(270),{type:l.spawn,enemy:"cloner",x:71,y:-20},{type:l.spawn,enemy:"cloner",x:286,y:-20}]}),Ze=ne({name:"cloner",hp:25,diameter:29,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),V({y:45,frames:150}),se(30),{type:l.spawn,enemy:"clonerChild"},{type:l.spawn,enemy:"clonerChild",actions:[{type:l.setAttribute,attribute:"mirrorX",value:!0}]},se(80),{type:l.spawn,enemy:"clonerChild",actions:[{type:l.setAttribute,attribute:"mirrorY",value:!0}]},{type:l.spawn,enemy:"clonerChild",actions:[{type:l.setAttribute,attribute:"mirrorX",value:!0},{type:l.setAttribute,attribute:"mirrorY",value:!0}]}]}),et=ne({name:"clonerChild",hp:10,diameter:18,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),q("mirrorX",{value:!0,yes:[{type:l.mirrorX,value:!0}]}),q("mirrorY",{value:!0,yes:[{type:l.mirrorY,value:!0}]}),te(1.5),K({type:l.move,x:-45,y:-20,frames:65},[se(60),X({type:l.shootDirection,x:0,y:1},se(40))])]}),tt=ne({name:"stage3",diameter:20,hp:9999,actions:[{type:l.gfxSetShape,shape:"none"},{type:l.spawn,enemy:"shapeShifter",x:179,y:Je[5]},{type:l.spawn,enemy:"healer",x:143,y:Je[4]},{type:l.spawn,enemy:"dehealer",x:214,y:Je[4]}]}),it=ne({name:"shapeShifter",diameter:30,hp:100,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.spawn,enemy:"shapeShifter",y:-20},{type:l.despawn}),X({type:l.gfxSetShape,shape:"circle"},se(60),{type:l.gfxSetShape,shape:"square"},se(60),{type:l.gfxSetShape,shape:"triangle"},se(60),{type:l.gfxSetShape,shape:"diamondShield"},se(60),{type:l.gfxSetShape,shape:"octagon"},se(60))]}),st=ne({name:"healer",diameter:30,hp:50,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.setAttribute,attribute:"hp",value:25},X(se(10),q("hp",{value:50,no:[{type:l.incr,attribute:"hp"}]}))]}),nt=ne({name:"dehealer",diameter:30,hp:50,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),X(se(10),{type:l.decr,attribute:"hp"})]}),at=({x:e=36,y:t=-30})=>({type:l.spawn,enemy:"easyFlyer",x:e,y:t}),ot=[{type:l.spawn,enemy:"easyFlyer",x:-100,y:0,actions:[{type:l.setMoveDirection,degrees:140}]},{type:l.spawn,enemy:"easyFlyer",x:-50,y:-50,actions:[{type:l.setMoveDirection,degrees:135}]},{type:l.spawn,enemy:"easyFlyer",x:0,y:-100,actions:[{type:l.setMoveDirection,degrees:135}]},{type:l.wait,frames:30},{type:l.spawn,enemy:"easyFlyer",x:321,y:Je[-1],actions:[{type:l.setMoveDirection,degrees:-135}]},{type:l.spawn,enemy:"easyFlyer",x:357,y:Je[0],actions:[{type:l.setMoveDirection,degrees:-135}]},{type:l.spawn,enemy:"easyFlyer",x:393,y:Je[1],actions:[{type:l.setMoveDirection,degrees:-135}]},{type:l.wait,frames:60}],rt=[{type:l.repeat,times:5,actions:[at({x:36,y:-20}),at({x:107,y:-20}),at({x:179,y:-20}),at({x:250,y:-20}),at({x:321,y:-20}),{type:l.wait,frames:80},at({x:0,y:-20}),at({x:71,y:-20}),at({x:143,y:-20}),at({x:214,y:-20}),at({x:286,y:-20}),at({x:357,y:-20}),{type:l.wait,frames:80}]}],lt=ne({name:"stage4",diameter:20,hp:9999,actions:[...ot,{type:l.wait,frames:240},...rt]}),pt=ne({name:"easyFlyer",diameter:29,hp:5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.setSpeed,pixelsPerFrame:1.17},{type:l.gfxSetColor,color:"green"},X({type:l.move_according_to_speed_and_direction},{type:l.waitNextFrame})]}),ht=ne({name:"parallax",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetColor,color:"black"},{type:l.gfxSetShape,shape:"square"},{type:l.gfxFillScreen},ee("layer1"),ee("layer2"),ee("layer3")]}),ct=ne({name:"layer1",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer1.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,y:-.3})]}),dt=ne({name:"layer2",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer2.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,y:-1})]}),mt=ne({name:"layer3",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer3.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,y:-1.5})]}),ut=ne({name:"stage5",diameter:20,hp:9999,actions:[{type:l.gfxSetShape,shape:"none"},ee("aqua",{x:36,y:Je[3]}),ee("executor",{x:71,y:Je[5]}),ee("shotSpeedFromHp",{x:107,y:Je[5]}),ee("repeatFromHp",{x:143,y:Je[5]}),ee("parent",{x:250,y:Je[5]})]}),yt=ne({name:"shotSpeedFromHp",diameter:20,hp:50,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetShape,shape:"octagon"},{type:l.gfxSetColor,color:"red"},{type:l.setShotSpeed,pixelsPerFrame:1.8},X(se({attr:"hp"}),{type:l.shootDirection,x:0,y:-1})]}),gt=ne({name:"repeatFromHp",diameter:20,hp:50,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetShape,shape:"octagon"},{type:l.gfxSetColor,color:"red"},{type:l.setShotSpeed,pixelsPerFrame:1.8},X(Q({attr:"hp"},[se(1)]),{type:l.shootDirection,x:0,y:-1})]}),ft=ne({name:"executor",diameter:30,hp:1e5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetColor,color:"green"},X({type:l.setAttribute,gameObjectId:"global",attribute:"aquaShoot",value:!0},se(1),{type:l.setAttribute,gameObjectId:"global",attribute:"aquaShoot",value:!1},se(35))]}),vt=ne({name:"aqua",diameter:30,hp:1e5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetColor,color:"aqua"},{type:l.setShotSpeed,pixelsPerFrame:2},X({type:l.waitUntilAttrIs,gameObjectId:"global",attr:"aquaShoot",is:!0},{type:l.shootDirection,x:0,y:1},se(1))]}),bt=ne({name:"child",diameter:20,hp:1e5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetColor,color:"aqua"},{type:l.waitUntilAttrIs,gameObjectId:{attr:"parentId"},attr:"hp",is:0},{type:l.setAttribute,attribute:"hp",value:0}]}),xt=ne({name:"parent",diameter:25,hp:5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.despawn}),{type:l.gfxSetColor,color:"red"},ee("child",{x:-30,y:-30}),ee("child",{x:0,y:-30}),ee("child",{x:30,y:-30})]}),wt={name:"1. Vertical level",startScreenImageUrl:e()?(await s((async()=>{const{default:e}=await import("./startScreen.js");return{default:e}}),[])).default:"",gameObjects:[he,ce,de,ht,ct,dt,mt,ae,oe,me,ue,Ie,Ae,_e,Ke,Qe,Ze,et,tt,it,st,nt,lt,pt,ut,ft,vt,yt,gt,bt,xt]},St=ne({name:"explosion",diameter:18,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"explosion"},se(40),{type:l.despawn}]}),It=ne({name:"roundExplosion",diameter:40,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"roundExplosion"},se(75),{type:l.despawn}]}),At=[(({moveDeltaX:e,moveDeltaY:t})=>({type:l.spawn,enemy:"playerShot",actions:[Y(X({type:l.moveDelta,x:e,y:t},{type:l.waitNextFrame}))]}))({moveDeltaY:0,moveDeltaX:9}),se(8)],Tt=ne({name:"player",diameter:20,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!0},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["enemy","enemyBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.finishLevel},{type:l.despawn}),{type:l.gfxSetColor,color:"aqua"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"collisionType",value:"player"},{type:l.setAttribute,attribute:"boundToWindow",value:!0},{type:l.gfxSetShape,shape:"none"},{type:l.setMoveDirection,degrees:90},se(1),{type:l.gfxSetShape,shape:"stage2/player.png"},Y(X({type:l.waitForInput,pressed:["shoot"],notPressed:["laser"]},...At))]}),Et=ne({name:"playerShot",hp:1,diameter:5,actions:[Y({type:l.waitUntilCollision,collisionTypes:["enemy"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"playerBullet"},{type:l.setAttribute,attribute:"pointsOnDeath",value:-1},{type:l.gfxSetShape,shape:"circle"},{type:l.gfxSetColor,color:"aqua"}]}),Dt=ne({name:"shot",hp:9999,diameter:5,actions:[{type:l.setAttribute,attribute:"collisionType",value:"enemyBullet"},{type:l.gfxSetShape,shape:"circle"}]}),kt=429,Ct=120,Ft=ne({name:"spawner",diameter:20,hp:9999,actions:[Y(se(18e3),{type:l.finishLevel}),{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},ee("parallax"),ee("player",{x:36,y:Ct}),ee("stage")]}),Pt=ee("nonShootingAimer",{x:393,y:72}),_t=ee("nonShootingAimer",{x:393,y:168}),Ot=Q(8,[Pt,_t,se(40)]),Mt=ne({name:"stage",diameter:20,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},se(60),Ot,se(60),ee("spinningDots",{x:kt,y:Ct}),se(480),ee("spinningDots",{x:kt,y:72}),se(90),ee("spinningDots",{x:kt,y:168}),se(480),ee("spinningDots",{x:kt,y:24}),se(90),ee("spinningDots",{x:kt,y:Ct}),se(90),ee("spinningDots",{x:kt,y:216}),se(360),ee("boss",{x:kt,y:Ct})]}),Wt=ne({name:"parallax",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetColor,color:"black"},{type:l.gfxSetShape,shape:"square"},{type:l.gfxFillScreen},ee("layer1"),ee("layer2"),ee("layer3")]}),Ut=ne({name:"layer1",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer1.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,x:.3})]}),Gt=ne({name:"layer2",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer2.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,x:1})]}),Lt=ne({name:"layer3",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer3.png"},{type:l.gfxFillScreen},X(se(1),{type:l.gfxScrollBg,x:1.5})]}),jt=ne({name:"nonShootingAimer",hp:1,diameter:22,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),Z(1.6),K(Q(26.25,[{type:l.rotate_towards_player},se(8)]),X({type:l.move_according_to_speed_and_direction},{type:l.waitNextFrame}))]}),Bt=ne({name:"dot",hp:20,diameter:20,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),{type:l.gfxSetShape,shape:"stage2/circle.png"}]}),Nt=ne({name:"traceDot",hp:9999,diameter:5,actions:[se(180),{type:l.despawn}]}),Rt=({x:e,y:t})=>({type:l.rotate_around_relative_point,degrees:-5400,frames:12e3,point:{x:e,y:t}}),$t=ne({name:"spinningDots",hp:9999,diameter:5,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("roundExplosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},{type:l.gfxSetShape,shape:"stage2/circle.png"},{type:l.gfxSetColor,color:"aqua"},ee("dot",{actions:[Y(X({type:l.moveDelta,x:-.55},{type:l.waitNextFrame}))]}),ee("dot",{x:27,actions:[Y(X({type:l.moveDelta,x:-.55},{type:l.waitNextFrame})),Y(Rt({x:-27}))]}),ee("dot",{x:54,actions:[Y(X({type:l.moveDelta,x:-.55},{type:l.waitNextFrame})),Y(Rt({x:-54}))]}),ee("dot",{x:-27,actions:[Y(X({type:l.moveDelta,x:-.55},{type:l.waitNextFrame})),Y(Rt({x:27}))]}),ee("dot",{x:-54,actions:[Y(X({type:l.moveDelta,x:-.55},{type:l.waitNextFrame})),Y(Rt({x:54}))]}),{type:l.despawn}]}),Ht=e=>[{type:l.gfxSetColor,color:"aqua"},{type:l.wait,frames:10},{type:l.gfxSetColor,color:"red"},{type:l.wait,frames:10},{type:l.setShotSpeed,pixelsPerFrame:e},{type:l.shootDirection,x:1,y:-1},{type:l.shootDirection,x:1,y:0},{type:l.shootDirection,x:1,y:1},{type:l.shootDirection,x:0,y:1},{type:l.shootDirection,x:-1,y:1},{type:l.shootDirection,x:-1,y:0},{type:l.shootDirection,x:-1,y:-1},{type:l.shootDirection,x:0,y:-1}],zt=[K([Q(4,[{type:l.setShotSpeed,pixelsPerFrame:.9},{type:l.shootTowardPlayer},{type:l.wait,frames:70}]),Q(10,[{type:l.setShotSpeed,pixelsPerFrame:1},{type:l.shootTowardPlayer},{type:l.wait,frames:28}]),Q(16,[{type:l.setShotSpeed,pixelsPerFrame:1.1},{type:l.shootTowardPlayer},{type:l.wait,frames:8}]),X({type:l.setShotSpeed,pixelsPerFrame:1.1},{type:l.shootTowardPlayer},{type:l.wait,frames:8})],[se(420),Q(5,[...Ht(.8),{type:l.wait,frames:300}]),X(...Ht(.8),{type:l.wait,frames:150})])],qt=[{type:l.moveToAbsolute,frames:450,moveTo:{x:179}}],Xt=ne({name:"boss",hp:1e5,diameter:40,actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},ee("bossCorpse"),{type:l.despawn}),{type:l.gfxSetShape,shape:"stage2/circle.png"},...qt,{type:l.setAttribute,attribute:"hp",value:70},K(zt)]}),Yt=(e,t)=>[ee("roundExplosion",{x:-e,y:0}),se(t),se(t),ee("roundExplosion",{x:e,y:0}),se(t),ee("roundExplosion",{x:0,y:-e}),se(t),ee("roundExplosion",{x:0,y:e}),ee("roundExplosion",{x:-e,y:-e}),ee("roundExplosion",{x:e,y:e}),se(t),ee("roundExplosion",{x:-e,y:e}),ee("roundExplosion",{x:e,y:-e})],Vt=ne({name:"bossCorpse",diameter:18,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"explosion"},K(Yt(8,3),Yt(24,5),Yt(16,15)),{type:l.wait,frames:180},{type:l.finishLevel}]}),Kt={name:"2. Horizontal level",startScreenImageUrl:e()?(await s((async()=>{const{default:e}=await import("./startScreen2.js");return{default:e}}),[])).default:"",gameObjects:[Tt,Et,Wt,Ut,Gt,Lt,St,It,Dt,Ft,Mt,Bt,Nt,$t,jt,Xt,Vt]},Jt=ne({name:"explosion",diameter:18,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"explosion"},se(40),{type:l.despawn}]}),Qt=ne({name:"roundExplosion",diameter:40,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"roundExplosion"},se(75),{type:l.despawn}]}),Zt=[Y(X({type:l.waitForInput,pressed:["left"]},{type:l.decr,attribute:"moveDirectionAngle",amount:3},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["right"]},{type:l.incr,attribute:"moveDirectionAngle",amount:3},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["up"]},{type:l.incr,attribute:"speed",amount:.04},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["down"]},{type:l.incr,attribute:"speed",amount:-.04},{type:l.waitNextFrame})),Y(X({type:l.move_according_to_speed_and_direction},{type:l.waitNextFrame}))],ei=[Y(X(q("x",{condition:"greaterThan",value:357,yes:[{type:l.setAttribute,attribute:"x",value:0}]}),q("x",{condition:"lessThan",value:0,yes:[{type:l.setAttribute,attribute:"x",value:357}]}),q("y",{condition:"greaterThan",value:240,yes:[{type:l.setAttribute,attribute:"y",value:0}]}),q("y",{condition:"lessThan",value:0,yes:[{type:l.setAttribute,attribute:"y",value:240}]}),se(1)))],ti=ne({name:"player",diameter:17,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["enemy","enemyBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},{type:l.finishLevel},{type:l.despawn}),{type:l.gfxSetColor,color:"aqua"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"collisionType",value:"player"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"none"},se(1),{type:l.gfxSetShape,shape:"diamondShield"},{type:l.setShotSpeed,pixelsPerFrame:5},Y(X({type:l.waitForInput,pressed:["shoot"]},{type:l.shootAccordingToMoveDirection,shot:"playerShot"},se(10))),...Zt,...ei]}),ii=ne({name:"playerShot",hp:1,diameter:5,options:{despawnMargin:5},actions:[Y({type:l.waitUntilCollision,collisionTypes:["enemy"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"playerBullet"},{type:l.setAttribute,attribute:"pointsOnDeath",value:-1},{type:l.gfxSetShape,shape:"circle"},{type:l.gfxSetColor,color:"aqua"}]}),si=ne({name:"shot",hp:1,diameter:5,options:{despawnMargin:5},actions:[Y({type:l.waitUntilCollision,collisionTypes:["player"]},ee("explosion"),{type:l.despawn}),{type:l.setAttribute,attribute:"collisionType",value:"enemyBullet"},{type:l.gfxSetShape,shape:"circle"}]}),ni=ne({name:"spawner",diameter:20,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},ee("parallax"),ee("player",{x:179,y:120}),ee("asteroidSpawner")]}),ai=ne({name:"parallax",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetColor,color:"black"},{type:l.gfxSetShape,shape:"square"},{type:l.gfxFillScreen},ee("layer1"),ee("layer2"),ee("layer3")]}),oi=ne({name:"layer1",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer1.png"},{type:l.gfxFillScreen}]}),ri=ne({name:"layer2",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer2.png"},{type:l.gfxFillScreen}]}),li=ne({name:"layer3",diameter:240,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer3.png"},{type:l.gfxFillScreen}]}),pi=[Y(X(q("x",{condition:"greaterThan",value:357,yes:[{type:l.setAttribute,attribute:"x",value:0}]}),q("x",{condition:"lessThan",value:0,yes:[{type:l.setAttribute,attribute:"x",value:357}]}),q("y",{condition:"greaterThan",value:240,yes:[{type:l.setAttribute,attribute:"y",value:0}]}),q("y",{condition:"lessThan",value:0,yes:[{type:l.setAttribute,attribute:"y",value:240}]}),se(1)))],hi=(e,t)=>({x:0,y:0,actions:[{type:l.setMoveDirection,degrees:t},Y({type:l.move,x:1e3*Math.cos(t*Math.PI/180),y:1e3*Math.sin(t*Math.PI/180),frames:8e3/e})]}),ci=(e,t,i)=>{const s=[];for(let n=0;n<e;n++){const a=360/e*n;s.push(ee(t,hi(i,a)))}return s},di=ne({name:"asteroid",diameter:24,hp:3,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},...ci(6,"smallAsteroid",1),{type:l.despawn}),{type:l.gfxSetColor,color:"red"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"pointsOnDeath",value:10},{type:l.setAttribute,attribute:"collisionType",value:"enemy"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},Y({type:l.move,x:{min:-2e3,max:2e3},y:{min:-2e3,max:2e3},frames:1e4}),{type:l.gfxSetShape,shape:"none"},se(1),{type:l.gfxSetShape,shape:"octagon"},...pi]}),mi=ne({name:"smallAsteroid",diameter:17,hp:2,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},...ci(4,"tinyAsteroid",1.3),{type:l.despawn}),{type:l.gfxSetColor,color:"red"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"pointsOnDeath",value:10},{type:l.setAttribute,attribute:"collisionType",value:"enemy"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"none"},se(1),{type:l.gfxSetShape,shape:"octagon"},...pi]}),ui=ne({name:"tinyAsteroid",diameter:8,hp:2,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.decr,attribute:"hp"},se(1))),Y({type:l.waitUntilAttrIs,attr:"hp",is:0},...ci(3,"tinyAsteroidFragment",1.6),{type:l.despawn}),{type:l.gfxSetColor,color:"red"},{type:l.setMoveDirection,degrees:0},{type:l.setAttribute,attribute:"pointsOnDeath",value:10},{type:l.setAttribute,attribute:"collisionType",value:"enemy"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"none"},se(1),{type:l.gfxSetShape,shape:"octagon"},...pi]}),yi=ne({name:"tinyAsteroidFragment",diameter:8,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y({type:l.waitUntilCollision,collisionTypes:["playerBullet"]},{type:l.despawn}),{type:l.gfxSetColor,color:"red"},{type:l.setAttribute,attribute:"pointsOnDeath",value:10},{type:l.setAttribute,attribute:"collisionType",value:"enemy"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"circle"},...pi]}),gi=ne({name:"asteroidSpawner",diameter:1,hp:9999,actions:[{type:l.gfxSetShape,shape:"none"},{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},X(ee("asteroid",{x:{min:0,max:y},y:{min:0,max:g}}),se(240))]}),fi={name:"3. Asteroids",startScreenImageUrl:e()?(await s((async()=>{const{default:e}=await import("./startScreen3.js");return{default:e}}),[])).default:"",gameObjects:[ti,ii,ai,oi,ri,li,Jt,Qt,si,di,mi,ui,yi,gi,ni]},vi=[Y(X({type:l.waitForInput,pressed:["left"]},{type:l.decr,attribute:"moveDirectionAngle",amount:3.5},{type:l.waitNextFrame})),Y(X({type:l.waitForInput,pressed:["right"]},{type:l.incr,attribute:"moveDirectionAngle",amount:3.5},{type:l.waitNextFrame})),Y(X({type:l.move_according_to_speed_and_direction},{type:l.waitNextFrame}))],bi=[Y(X(q("x",{condition:"greaterThan",value:348.5,yes:[{type:l.finishLevel},{type:l.despawn}]}),q("x",{condition:"lessThan",value:8.5,yes:[{type:l.finishLevel},{type:l.despawn}]}),q("y",{condition:"greaterThan",value:231.5,yes:[{type:l.finishLevel},{type:l.despawn}]}),q("y",{condition:"lessThan",value:8.5,yes:[{type:l.finishLevel},{type:l.despawn}]}),se(1)))],xi=ne({name:"player",diameter:17,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[Y(X({type:l.waitUntilCollision,collisionTypes:["apple"]},{type:l.incr,gameObjectId:"global",attribute:"applesEaten"},{type:l.addPoints,points:100},{type:l.attrIf,condition:"greaterThanOrEqual",gameObjectId:"global",attrName:"applesEaten",value:10,yes:[{type:l.incr,gameObjectId:"global",attribute:"ttl",amount:60}],no:[{type:l.incr,gameObjectId:"global",attribute:"ttl",amount:45}]},se(1))),Y({type:l.waitUntilCollision,collisionTypes:["snakeBody"]},{type:l.finishLevel},{type:l.despawn}),{type:l.setAttribute,gameObjectId:"global",attribute:"ttl",value:10},{type:l.setAttribute,gameObjectId:"global",attribute:"applesEaten",value:0},{type:l.gfxSetColor,color:"aqua"},{type:l.setMoveDirection,degrees:90},{type:l.setAttribute,attribute:"collisionType",value:"player"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"circle"},{type:l.incr,attribute:"speed",amount:.72},...vi,...bi,Y(X(se(Math.round(19/1.2)),ee("snakeBody")))]}),wi=ne({name:"spawner",diameter:20,hp:9999,options:{despawnWhenOutsideScreen:!1},actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"none"},ee("parallax"),ee("player",{x:36,y:216}),ee("appleSpawner")]}),Si=ne({name:"parallax",diameter:240,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetColor,color:"black"},{type:l.gfxSetShape,shape:"square"},{type:l.gfxFillScreen},ee("layer1"),ee("layer2"),ee("layer3")]}),Ii=ne({name:"layer1",diameter:240,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer1.png"},{type:l.gfxFillScreen}]}),Ai=ne({name:"layer2",diameter:240,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer2.png"},{type:l.gfxFillScreen}]}),Ti=ne({name:"layer3",diameter:240,hp:9999,actions:[{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.gfxSetShape,shape:"layer3.png"},{type:l.gfxFillScreen}]}),Ei=(e,t)=>[{type:l.setAttribute,attribute:"diameter",value:e},{type:l.gfxSetDiameter,diameter:e},se(t)],Di=Math.round(8/1.2),ki=[se({gameObjectId:"global",attr:"ttl"}),...Ei(14.5,Di),...Ei(14,Di),...Ei(13.5,Di),...Ei(13,Di),...Ei(12.5,Di),...Ei(12,Di),...Ei(11.5,Di),{type:l.despawn}],Ci=ne({name:"snakeBody",diameter:15,hp:1,options:{despawnWhenOutsideScreen:!1,defaultDirectionalControls:!1},actions:[{type:l.gfxSetColor,color:"aqua"},{type:l.setMoveDirection,degrees:90},{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"none"},se(Math.round(4/1.2)),Y(se(Math.round(25)),{type:l.setAttribute,attribute:"collisionType",value:"snakeBody"}),{type:l.gfxSetShape,shape:"circle"},{type:l.incr,attribute:"speed",amount:0},...ki]}),Fi=ne({name:"appleSpawner",diameter:17,hp:9999,actions:[{type:l.gfxSetColor,color:"red"},{type:l.setMoveDirection,degrees:90},{type:l.setAttribute,attribute:"collisionType",value:"none"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"none"},{type:l.incr,attribute:"speed",amount:0},Y(X(ee("apple",{x:{min:0,max:y},y:{min:0,max:g}}),se(240)))]}),Pi=ne({name:"apple",diameter:12,hp:1,actions:[Y({type:l.waitUntilCollision,collisionTypes:["player"]},{type:l.despawn}),{type:l.gfxSetColor,color:"red"},{type:l.setMoveDirection,degrees:90},{type:l.setAttribute,attribute:"collisionType",value:"apple"},{type:l.setAttribute,attribute:"boundToWindow",value:!1},{type:l.gfxSetShape,shape:"circle"},{type:l.incr,attribute:"speed",amount:0},se(600),{type:l.despawn}]}),_i={name:"4. Snake",startScreenImageUrl:e()?(await s((async()=>{const{default:e}=await import("./startScreen4.js");return{default:e}}),[])).default:"",gameObjects:[xi,Ci,Fi,Pi,Si,Ii,Ai,Ti,Jt,Qt,wi]};class Oi{name;games;activeGame;constructor({name:e}){this.name=e,this.games=[],this.activeGame=0}addGame=e=>{const t={};for(const i of e.gameObjects)t[i.name]=i;this.games.push({name:e.name,gameObjects:t,startScreenImageUrl:e.startScreenImageUrl})};Init=()=>(this.addGame(wt),this.addGame(Kt),this.addGame(fi),this.addGame(_i),Promise.resolve());setActiveGame=e=>{this.activeGame=e};getActiveGame=()=>this.activeGame;getAndAssertActiveGame=()=>{if(void 0===this.activeGame)throw new Error("GameData.getAndAssertActiveGame: activeGame is undefined.");return this.activeGame};getGames=()=>Object.keys(this.games);getGameNames=()=>Object.values(this.games).map((e=>e.name));GetEnemy=e=>{if(void 0===this.activeGame)throw new Error("GameData.GetEnemy: Error activeGame is not set.");const t=this.games[this.activeGame]?.gameObjects?.[e];if(!t)throw new Error(`GameData.GetEnemy: Unknown enemy "${e}".`);return t};getStartScreenImageUrl=()=>{if(void 0===this.activeGame)throw new Error("GameData.GetStartScreenImageUrl: Error activeGame is not set.");const e=this.games[this.activeGame]?.startScreenImageUrl;if(!e)throw new Error("GameData.GetStartScreenImageUrl: No startScreenImageUrl.");return e}}const Mi=e()?"/schmupinator/images/circle.png":"",Wi=e()?"/schmupinator/images/square.png":"",Ui=e()?"/schmupinator/images/triangle.png":"",Gi=e()?"/schmupinator/images/diamondShield.png":"",Li=e()?"/schmupinator/images/octagon.png":"",ji=e()?"/schmupinator/images/explosion.png":"",Bi=e()?"/schmupinator/images/roundExplosion.png":"";class Ni{vars={x:100,y:100,scale:1,rotation:0,shape:"circle",color:"red",diameter:5};element;logError=(...e)=>{console.error("GraphicsElement:",...e)};logWarn=(...e)=>{};constructor(e,t){this.element=o.WithWindow((i=>{const s=i.document.createElement("div");return this.applyUnchangingDefaults(s),this.resetElement(e,t,s),i.document.body.appendChild(s),s}))}destroy=()=>{void 0!==this.element&&(this.element.remove(),this.element=void 0)};applyUnchangingDefaults(e){e.style.position="fixed",e.style.boxSizing="border-box",e.style.backgroundSize="contain",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center",e.style.zIndex="0"}reset=(e,t)=>{void 0!==this.element?this.resetElement(e,t,this.element):this.logError("Tried to reset an undefined element")};resetElement=(e,t,i)=>{this.vars={color:"red",diameter:5,rotation:0,scale:1,shape:"circle",x:e,y:t};const s=this.vars.diameter/2,n=t-s,a=e-s;i.style.backgroundImage=`url('${Mi}')`,i.style.filter="none",i.style.width=O(this.vars.diameter),i.style.height=O(this.vars.diameter),i.style.top=O(n),i.style.left=O(a),i.style.transform="rotate(0deg) scale(1)"};setX=e=>{if(void 0===this.element)return void this.logError("Tried to setX of undefined element");if(this.vars.x===e)return void this.logWarn(`Tried to setX to ${e} when it was already ${e}`);const t=this.vars.diameter/2;this.vars.x=e,this.element.style.left=O(e-t)};setY=e=>{if(void 0===this.element)return void this.logError("Tried to setY of undefined element");if(this.vars.y===e)return void this.logWarn(`Tried to setY to ${e} when it was already ${e}`);const t=this.vars.diameter/2;this.vars.y=e,this.element.style.top=O(e-t)};setDiameter=e=>{if(void 0===this.element)return void this.logError("Tried to setDiameter of undefined element");if(this.vars.diameter===e)return void this.logWarn(`Tried to setDiameter to ${e} when it was already ${e}`);this.vars.diameter=e;const t=e/2,i=this.element.style;i.width=O(e),i.height=O(e),i.left=O(this.vars.x-t),i.top=O(this.vars.y-t)};setColor=e=>{if(void 0!==this.element)if(this.vars.color!==e)switch(this.vars.color=e,e){case"red":this.element.style.filter="none";break;case"black":this.element.style.filter="brightness(0)";break;case"green":this.element.style.filter="hue-rotate(135deg) brightness(1.09)";break;case"aqua":this.element.style.filter="hue-rotate(180deg) brightness(3)";break;default:o.Alert(`Graphics.actionSetColor: unknown color '${e}'`)}else this.logWarn(`Tried to setColor to ${e} when it was already ${e}`);else this.logError("Tried to setColor of undefined element")};setShape=e=>{if(void 0!==this.element)if(this.vars.shape!==e)switch(this.vars.shape=e,e){case"none":this.element.style.backgroundImage="none";break;case"circle":this.element.style.backgroundImage=`url('${Mi}')`;break;case"square":this.element.style.backgroundImage=`url('${Wi}')`;break;case"triangle":this.element.style.backgroundImage=`url('${Ui}')`;break;case"diamondShield":this.element.style.backgroundImage=`url('${Gi}')`;break;case"octagon":this.element.style.backgroundImage=`url('${Li}')`;break;case"explosion":{const e=`?id=${Date.now()}`;this.element.style.backgroundImage=`url('${ji}${e}')`;break}case"roundExplosion":{const e=`?id=${Date.now()}`;this.element.style.backgroundImage=`url('${Bi}${e}')`;break}default:this.element.style.backgroundImage=`url('/schmupinator/images/${e}')`}else this.logWarn(`Tried to setShape to ${e} when it was already ${e}`);else this.logError("Tried to setShape of undefined element")};setRotation=e=>{void 0!==this.element?this.vars.rotation!==e?(this.vars.rotation=e,this.element.style.transform=`rotate(${this.vars.rotation}deg) scale(${this.vars.scale})`):this.logWarn(`Tried to setRotation to ${e} when it was already ${e}`):this.logError("Tried to setRotation of undefined element")};setScale=e=>{void 0!==this.element?this.vars.scale!==e?(this.vars.scale=e,this.element.style.transform=`rotate(${this.vars.rotation}deg) scale(${this.vars.scale})`):this.logWarn(`Tried to setScale to ${e} when it was already ${e}`):this.logError("Tried to setScale of undefined element")};scrollBg=({x:e,y:t})=>{if(void 0!==this.element){if(void 0!==e){const t=this.element.style.backgroundPositionX.replace("px",""),i=(parseFloat(t)||0)+e;this.element.style.backgroundRepeat="repeat",this.element.style.backgroundPositionX=O(i)}if(void 0!==t){const e=this.element.style.backgroundPositionY.replace("px",""),i=(parseFloat(e)||0)+t;this.element.style.backgroundRepeat="repeat",this.element.style.backgroundPositionY=O(i)}}else this.logError("Tried to scrollBg of undefined element")};fillScreen=()=>{if(void 0===this.element)return void this.logError("Tried to fillScreen of undefined element");const e=this.element.style;e.width=O(y),e.height=O(g),e.backgroundSize="cover",e.left=O(0),e.top=O(0)}}class Ri{name;elementPool;static poolSize=150;constructor({name:e}){this.name=e,this.elementPool=this.initElementPool()}destroy=()=>{for(const e of Object.values(this.elementPool))void 0!==e&&e.element.destroy();this.elementPool={}};Init=async()=>{};Dispatch=e=>{switch(e.type){case l.gfxAskForElement:return this.actionAskForElement();case l.gfxSetPosition:return this.actionSetPosition(e);case l.gfxSetDiameter:return this.actionSetDiameter(e);case l.gfxRelease:return this.actionRelease(e);case l.gfxSetColor:return this.actionSetColor(e);case l.gfxSetShape:return this.actionSetShape(e);case l.gfxSetRotation:return this.actionSetRotation(e);case l.gfxSetScale:return this.actionSetScale(e);case l.gfxScrollBg:return this.actionScrollBg(e);case l.gfxFillScreen:return this.actionFillScreen(e);default:{const t=`unknown action type: ${e.type}`;throw o.Alert(t),new Error(t)}}};getRestingPlace=e=>({x:377+10*Math.floor(e/10),y:20+e%10*10});initElementPool=()=>{const e=Array(Ri.poolSize).fill(0),t={};for(const[i]of e.entries()){const e=this.initOneElement(i);t[e.handle]=e}return t};initOneElement=e=>{const{x:t,y:i}=this.getRestingPlace(e);return{handle:`${A("guid")}`,inUse:!1,element:new Ni(t,i),index:e}};findExistingAndInUse=e=>{const t=this.elementPool[e];if(!t)throw o.Alert(`Graphics: No GraphicsElement with handle "${e}"!`),new Error(`Graphics: No GraphicsElement with handle "${e}"!`);if(!t.inUse)throw o.Alert(`Graphics: Trying to set position for unused handle "${e}"!`),new Error(`Graphics: Trying to set position for unused handle "${e}"!`);return t};actionAskForElement=()=>{const e=Object.values(this.elementPool).find((e=>!e.inUse));if(e)return e.inUse=!0,{type:"responseAskForElement",handle:e.handle};throw o.Alert("Graphics: All elements are in use!"),new Error("Graphics: All elements are in use!")};actionSetPosition=({handle:e,x:t,y:i})=>{const s=this.findExistingAndInUse(e);return void 0!==t&&s.element.setX(t),void 0!==i&&s.element.setY(i),{type:"responseVoid"}};actionSetDiameter=({handle:e,diameter:t})=>(this.findExistingAndInUse(e).element.setDiameter(t),{type:"responseVoid"});actionRelease=({handle:e})=>{const t=this.findExistingAndInUse(e),{x:i,y:s}=this.getRestingPlace(t.index);return t.element.reset(i,s),t.inUse=!1,{type:"responseVoid"}};actionSetColor=({handle:e,color:t})=>(this.findExistingAndInUse(e).element.setColor(t),{type:"responseVoid"});actionSetShape=({handle:e,shape:t})=>(this.findExistingAndInUse(e).element.setShape(t),{type:"responseVoid"});actionSetRotation=({handle:e,degrees:t})=>(this.findExistingAndInUse(e).element.setRotation(t),{type:"responseVoid"});actionSetScale=({handle:e,scale:t})=>(this.findExistingAndInUse(e).element.setScale(t),{type:"responseVoid"});actionScrollBg=({handle:e,x:t,y:i})=>(this.findExistingAndInUse(e).element.scrollBg({x:t,y:i}),{type:"responseVoid"});actionFillScreen=({handle:e})=>(this.findExistingAndInUse(e).element.fillScreen(),{type:"responseVoid"})}const $i=e()?"/schmupinator/images/menuBackground.png":"",Hi=()=>o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.backgroundImage=`url('${$i}')`,t.style.filter="brightness(70%)",t.style.backgroundSize="cover",t.style.top=O(0),t.style.left=O(0),t.style.width=O(y),t.style.height=O(g),t.style.zIndex=v,e.document.body.appendChild(t),t})),zi=e=>{const t=e.offsetWidth/2;return e.style.left=O(178.5-t),e},qi=e=>{const{text:t,fontSize:i=16,left:s,top:n,right:a,className:r="",color:l="red",onClick:p=null,onMouseEnter:h=null,onMouseLeave:c=null}=e;return o.WithWindow((e=>{const o=e.document.createElement("div");return o.style.position="fixed",void 0!==n&&(o.style.top=O(n)),void 0!==s&&(o.style.left=O(s)),void 0!==a&&(o.style.right=O(a)),o.style.color=l,o.style.fontSize=O(i),o.style.whiteSpace="pre",o.style.zIndex=v,o.innerHTML=t,o.className=r,o.onclick=p,o.onmouseenter=h,o.onmouseleave=c,e.document.body.appendChild(o),o}))};class Xi{top;menuItems;static spaceBetweenMenuItems=25;activeItemIndex;input;menuItemElements=[];constructor(e){this.input=e.input,this.top=e.top,this.menuItems=e.menuItems.map(((e,t)=>({...e,index:t})))}render(){this.menuItemElements=this.menuItems.map(((e,t)=>{const i=qi({text:e.text,fontSize:j.normal,top:this.top+t*Xi.spaceBetweenMenuItems,onClick:e.onClick,className:"menuItem",onMouseEnter:()=>{this.setActiveIndex(t)}});return zi(i),i})),this.setActiveIndex(0),this.input.onKeyUpCallback=e=>{switch(e){case"up":this.decrActive();break;case"down":this.incrActive();break;case"start":case"laser":case"shoot":void 0!==this.activeItemIndex&&this.menuItems[this.activeItemIndex].onClick()}}}destroy(){this.input.onKeyUpCallback=void 0;for(const e of this.menuItemElements)e.remove();this.menuItemElements=[],this.activeItemIndex=void 0}setActiveIndex=e=>{this.activeItemIndex!==e&&(void 0!==this.activeItemIndex&&this.unsetActiveItem(this.activeItemIndex),this.activeItemIndex=e,this.menuItemElements[e].classList.add("activeMenuItem"))};unsetActiveItem=e=>{this.activeItemIndex===e&&(this.activeItemIndex=void 0,this.menuItemElements[e].classList.remove("activeMenuItem"))};incrActive=()=>{void 0!==this.activeItemIndex&&this.activeItemIndex<this.menuItems.length-1&&this.setActiveIndex(this.activeItemIndex+1)};decrActive=()=>{void 0!==this.activeItemIndex&&this.activeItemIndex>=1&&this.setActiveIndex(this.activeItemIndex-1)}}class Yi{ui;shadeElement;title;menu;version;constructor(e){this.ui=e.ui}render(){this.ui.settingsService.settings.skipStartMenu?this.onStartGame():(this.shadeElement=Hi(),this.title=qi({text:'<span class="flash3s"><span style="font-size: 76px;">S</span>chmupinator</span>',fontSize:60,top:36}),zi(this.title),this.menu=new Xi({input:this.ui.input,top:108,menuItems:[{text:"start game",onClick:this.onStartGame},{text:"highscore",onClick:()=>{this.ui.SetActiveScene(this.ui.selectGameForHighscore)}},{text:"settings",onClick:()=>{this.ui.SetActiveScene(this.ui.settings)}}]}),this.menu.render(),this.version=qi({text:"0.7.0",fontSize:j.smallest,top:225,left:333,color:"rgba(255, 0, 0, 0.4)"}))}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.menu?.destroy(),this.version?.remove(),this.version=void 0}onStartGame=()=>{this.ui.SetActiveScene(this.ui.selectGame)}}class Vi{ui;scoreElement;hiscoreElement;constructor(e){this.ui=e.ui}render(){this.scoreElement=qi({text:"Score 0",color:"white",fontSize:j.smallest,top:10,left:20});const e=this.ui.highscoreService.getTop1().score;this.hiscoreElement=qi({text:`Record ${e}`,color:"white",fontSize:j.smallest,top:10,left:285}),this.ui.eventsUi.subscribeToEvent("GameUI",this.onEvent)}destroy(){this.scoreElement?.remove(),this.scoreElement=void 0,this.hiscoreElement?.remove(),this.hiscoreElement=void 0,this.ui.events.unsubscribeToEvent("GameUI")}onEvent=e=>{"uiScoreUpdated"===e.type&&this.scoreElement&&(this.scoreElement.innerHTML=`Score ${Math.round(e.points)}`)}}class Ki{interval;originalSecondsLeft;currentSecondsLeft;onDone;input;element;constructor(e){const{input:t,secondsLeft:i,onDone:s,fontSize:n=j.smallest,left:a=0,top:r=0,className:l=""}=e;this.input=t,this.originalSecondsLeft=i,this.currentSecondsLeft=i,this.onDone=s,this.element=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.position="fixed",t.style.top=O(r),t.style.left=O(a),t.style.color="red",t.style.fontSize=O(n),t.style.whiteSpace="pre",t.style.zIndex=v,t.innerHTML=`${i}`,t.className=l,e.document.body.appendChild(t),t})),this.interval=o.SetInterval(this.tick,1e3),this.input.onKeyUpCallback=e=>{switch(e){case"laser":case"shoot":case"start":this.originalSecondsLeft-this.currentSecondsLeft>=1&&(this.destroy(),this.onDone())}}}destroy=()=>{this.input.onKeyUpCallback=void 0,o.WithWindow((e=>{e.clearInterval(this.interval)})),this.element.remove()};tick=()=>{this.currentSecondsLeft--,this.element.innerHTML=`${this.currentSecondsLeft}`,this.currentSecondsLeft<1&&(this.destroy(),this.onDone())}}class Ji{ui;shadeElement;textElement;countdown;constructor(e){this.ui=e.ui}render(){this.shadeElement=Hi(),this.textElement=qi({text:"Game Over",fontSize:j.largest,top:95}),zi(this.textElement),this.countdown=new Ki({input:this.ui.input,secondsLeft:5,onDone:this.handleCountdDownDone,fontSize:j.largest,top:130}),zi(this.countdown.element)}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.textElement?.remove(),this.textElement=void 0,this.countdown?.destroy(),this.countdown=void 0}handleCountdDownDone=()=>{const e=this.ui.points.points,{qualifiedForTop10:t,rank:i}=this.ui.highscoreService.qualifiedForTop10(e);t?this.ui.SetActiveScene(this.ui.enterHighscore,i):o.WithWindow((e=>{e.location.reload()}))}}const Qi=(e,t)=>{const i=t-e.length;return`${e}${Array(i).fill(" ").join("")}`};class Zi{ui;rank;backButton=!1;shadeElement;title;top10;menu;constructor(e){this.ui=e.ui}padRank=e=>Qi(e,10);padScore=e=>Qi(e,11);getTop10Text=()=>[this.padRank("rank")+this.padScore("Score")+"Player",...this.ui.highscoreService.getTop10().map((({name:e,score:t},i)=>{const s=this.padRank(`${i+1}`),n=this.padScore(`${t}`);return E(this.rank)&&this.rank===i?`<span class="flash1s">${s}${n}${e}</span>`:`${s}${n}${e}`}))].join("\n");render(e){T(e)&&(E(e.rank)&&(this.rank=e.rank),"boolean"==typeof e.backButton&&(this.backButton=e.backButton)),this.shadeElement=Hi(),this.title=qi({text:"Highscore",fontSize:j.large,top:5}),zi(this.title),this.top10=qi({text:this.getTop10Text(),fontSize:j.smaller,top:38}),zi(this.top10),this.menu=new Xi({input:this.ui.input,top:207,menuItems:[{text:this.backButton?"back":"continue",onClick:this.handleExit}]}),this.menu.render()}destroy(){this.rank=void 0,this.backButton=!1,this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.top10?.remove(),this.top10=void 0,this.menu?.destroy()}handleExit=()=>{this.backButton?this.ui.SetActiveScene(this.ui.startGame):o.WithWindow((e=>{e.location.reload()}))}}const es=["_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];class ts{top;caretIndex=0;charIndices=[0,0,0,0,0,0];onDone;input;charElements=[];constructor(e){this.input=e.input,this.top=e.top,this.onDone=e.onDone}render(){const e=this.charIndices.map((e=>es[e])).map((e=>({text:e}))).map(((e,t)=>({...e,index:t})));this.charElements=e.map(((e,t)=>{const i=j.large;return qi({text:e.text,fontSize:i,top:this.top,left:136+t*i*.37,className:"menuItem",onMouseEnter:()=>{this.setCaretIndex(t)}})})),this.setCaretIndex(0,!0),this.input.onKeyUpCallback=e=>{switch(e){case"up":this.incrCurrCharIndex();break;case"down":this.decrCurrCharIndex();break;case"left":this.decrCaretIndex();break;case"right":this.incrCaretIndex();break;case"start":this.onDone(this.getEnteredString())}}}destroy(){this.input.onKeyUpCallback=void 0;for(const e of this.charElements)e.remove();this.charElements=[],this.caretIndex=0}getEnteredString=()=>this.charIndices.map((e=>es[e])).join("").replaceAll("_"," ");updateCurrChar=()=>{const e=this.charIndices[this.caretIndex];this.charElements[this.caretIndex].innerHTML=es[e]};incrCurrCharIndex=()=>{this.charIndices[this.caretIndex]++,this.charIndices[this.caretIndex]>es.length-1&&(this.charIndices[this.caretIndex]=0),this.updateCurrChar()};decrCurrCharIndex=()=>{this.charIndices[this.caretIndex]--,this.charIndices[this.caretIndex]<0&&(this.charIndices[this.caretIndex]=es.length-1),this.updateCurrChar()};setCaretIndex=(e,t=!1)=>{(t||this.caretIndex!==e)&&(this.charElements[this.caretIndex].classList.remove("activeMenuItem"),this.caretIndex=e,this.charElements[e].classList.add("activeMenuItem"))};incrCaretIndex=()=>{this.caretIndex<this.charIndices.length-1&&this.setCaretIndex(this.caretIndex+1)};decrCaretIndex=()=>{this.caretIndex>=1&&this.setCaretIndex(this.caretIndex-1)}}class is{ui;rank;shadeElement;title;subTitle;flipCharacters;constructor(e){this.ui=e.ui}render(e){E(e)&&(this.rank=e),this.shadeElement=Hi(),this.title=qi({text:"Made it into the Highscore",fontSize:j.normal,top:20,className:"flash1s"}),zi(this.title),this.subTitle=qi({text:"Enter thy name and\n become a legend",fontSize:j.small,top:70,className:"flash1s"}),zi(this.subTitle),this.flipCharacters=new ts({input:this.ui.input,top:130,onDone:this.onEnteredName}),this.flipCharacters.render()}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.subTitle?.remove(),this.subTitle=void 0,this.flipCharacters?.destroy()}onEnteredName=e=>{this.ui.highscoreService.registerNewEntry({name:e,score:this.ui.points.points}),this.ui.SetActiveScene(this.ui.highscore,{rank:this.rank})}}let ss=class{ui;shadeElement;title;menu;constructor(e){this.ui=e.ui}render(){const{fullscreen:e,gameSpeedSlider:t,fpsStats:i,outsideHider:s,autoplay:n,invincibility:a}=this.ui.settingsService.settings;this.shadeElement=Hi(),this.title=qi({text:'<span class="flash3s"><span style="font-size: 76px;">S</span>ettings</span>',fontSize:60,top:0}),zi(this.title),this.menu=new Xi({input:this.ui.input,top:60,menuItems:[{text:"fullscreen - "+(e?"on":"off"),onClick:()=>{this.toggleSetting("fullscreen")}},{text:"fpsStats - "+(i?"on":"off"),onClick:()=>{this.toggleSetting("fpsStats")}},{text:"gameSpeedSlider - "+(t?"on":"off"),onClick:()=>{this.toggleSetting("gameSpeedSlider")}},{text:"outsideHider - "+(s?"on":"off"),onClick:()=>{this.toggleSetting("outsideHider")}},{text:"autoplay - "+(n?"on":"off"),onClick:()=>{this.toggleSetting("autoplay")}},{text:"invincibility - "+(a?"on":"off"),onClick:()=>{this.toggleSetting("invincibility")}},{text:"back",onClick:()=>{this.ui.SetActiveScene(this.ui.startGame)}}]}),this.menu.render()}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.menu?.destroy()}toggleSetting=e=>{this.ui.settingsService.toggleSetting(e),this.refresh()};refresh=()=>{this.destroy(),this.render()}};class ns{ui;bgImageElement;countdown;constructor(e){this.ui=e.ui}render(){var e;this.ui.settingsService.settings.skipStartMenu?this.handleCountdDownDone():(this.bgImageElement=(e=this.ui.gameData.getStartScreenImageUrl(),o.WithWindow((t=>{const i=t.document.createElement("div");return i.style.position="fixed",i.style.backgroundImage=`url('${e}')`,i.style.backgroundSize="cover",i.style.top=O(0),i.style.left=O(0),i.style.width=O(y),i.style.height=O(g),i.style.zIndex=v,t.document.body.appendChild(i),i}))),this.countdown=new Ki({input:this.ui.input,secondsLeft:6,onDone:this.handleCountdDownDone,fontSize:j.large,top:5,left:315}))}destroy(){this.bgImageElement?.remove(),this.bgImageElement=void 0,this.countdown?.destroy(),this.countdown=void 0}handleCountdDownDone=()=>{this.ui.gameLoop.Start(),this.ui.SetActiveScene(this.ui.game)}}class as{ui;shadeElement;title;menu;constructor(e){this.ui=e.ui}render(){if(this.ui.settingsService.settings.skipStartMenu)return void this.onSelectGame(0);this.shadeElement=Hi(),this.title=qi({text:'<span class="flash3s"><span style="font-size: 76px;">S</span>elect game</span>',fontSize:60,top:36}),zi(this.title);const e=this.ui.gameData.getGameNames().map(((e,t)=>({text:e,onClick:()=>{this.onSelectGame(t)}})));this.menu=new Xi({input:this.ui.input,top:108,menuItems:[...e,{text:"back",onClick:()=>{this.ui.SetActiveScene(this.ui.startGame)}}]}),this.menu.render()}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.menu?.destroy()}onSelectGame=e=>{this.ui.gameData.setActiveGame(e),this.ui.SetActiveScene(this.ui.displayControls)}}class os{ui;shadeElement;title;menu;constructor(e){this.ui=e.ui}render(){this.shadeElement=Hi(),this.title=qi({text:'<span class="flash3s"><span style="font-size: 76px;">S</span>elect game</span>',fontSize:60,top:36}),zi(this.title);const e=this.ui.gameData.getGameNames().map(((e,t)=>({text:e,onClick:()=>{this.onSelectGame(t)}})));this.menu=new Xi({input:this.ui.input,top:108,menuItems:[...e,{text:"back",onClick:()=>{this.ui.SetActiveScene(this.ui.startGame)}}]}),this.menu.render()}destroy(){this.shadeElement?.remove(),this.shadeElement=void 0,this.title?.remove(),this.title=void 0,this.menu?.destroy()}onSelectGame=e=>{this.ui.gameData.setActiveGame(e),this.ui.SetActiveScene(this.ui.highscore,{backButton:!0})}}class rs{name;events;eventsUi;gameLoop;highscoreService;points;settingsService;input;gameData;startGame;selectGame;settings;game;gameOver;highscore;selectGameForHighscore;enterHighscore;displayControls;activeScene;constructor({name:e}){this.name=e,this.startGame=new Yi({ui:this}),this.selectGame=new as({ui:this}),this.settings=new ss({ui:this}),this.game=new Vi({ui:this}),this.gameOver=new Ji({ui:this}),this.highscore=new Zi({ui:this}),this.selectGameForHighscore=new os({ui:this}),this.enterHighscore=new is({ui:this}),this.displayControls=new ns({ui:this})}Init=async e=>{this.events=e?.events,this.eventsUi=e?.eventsUi,this.gameLoop=e?.gameLoop,this.highscoreService=e?.highscore,this.points=e?.points,this.settingsService=e?.settings,this.input=e?.input,this.gameData=e?.gameData,this.events.subscribeToEvent(this.name,this.onEvent),this.SetActiveScene(this.startGame)};SetActiveScene=(e,t)=>{e!==this.activeScene?(this.activeScene&&this.activeScene.destroy(),this.activeScene=e,this.activeScene.render(t)):console.warn("Trying to set a scene to active which is already active.")};onEvent=e=>{"gameOver"===e.type&&(this.gameLoop.pause(),this.SetActiveScene(this.gameOver))};destroy=()=>{this.startGame.destroy(),this.settings.destroy(),this.game.destroy(),this.gameOver.destroy(),this.highscore.destroy(),this.enterHighscore.destroy(),this.displayControls.destroy(),this.events.unsubscribeToEvent(this.name),this.activeScene=void 0}}class ls{name;scale;gameAspectRatio=1.4875;constructor({name:e}){this.name=e,this.scale=1,this.setFullscreen(),o.WithWindow((e=>{e.addEventListener("resize",this.setFullscreen)}))}Init=async()=>{};destroy=()=>{o.WithWindow((e=>{e.removeEventListener("resize",this.setFullscreen),e.document.body.style.transform="none",e.document.body.style.width="100%",e.document.body.style.height="100%"}))};setFullscreen=()=>{o.WithWindow((e=>{const t=e.document.body,i=e.document.documentElement.clientWidth,s=e.document.documentElement.clientHeight;if(i/s>this.gameAspectRatio){this.scale=s/g;let e=0;e=(i-y*this.scale)/2,t.style.transform=`translateX(${e}px) scale(${this.scale})`}else this.scale=i/y,t.style.transform=`scale(${this.scale})`;t.style.width=1/this.scale*100+"%",t.style.height=1/this.scale*100+"%"}))}}class ps{name;recordedHistory;startTime=0;attributes;events;constructor({name:e}){this.name=e}Init=async e=>{this.recordedHistory=(await s((async()=>{const{recordedHistory:e}=await import("./e2ehistory.js");return{recordedHistory:e}}),[])).recordedHistory,this.events=e?.events,this.attributes=e?.attributes,this.events.subscribeToEvent(this.name,this.onEvent)};onEvent=t=>{if("gameOver"===t.type){console.log("E2eTest: Test succeeded.");const t=o.PerformanceNow()-this.startTime;console.log(`E2eTest: Took ${t} ms to run test.`),e()||o.ProcessExit(0)}if("frame_tick"===t.type){const e=t.frameNr-1;0===this.startTime&&(this.startTime=o.PerformanceNow());const i=this.attributes.attributes,s={};for(const[t,o]of Object.entries(i.gameObjects))s[t]=o?.hp;const n=JSON.stringify(s),a=JSON.stringify(this.recordedHistory[e]);a!==n&&o.Alert(`Test failed!\nFrame: ${e}\nExpected: ${a}\nActual: ${n}`)}}}const hs="__settings";class cs{name;settings={fullscreen:!0,gameSpeedSlider:!1,fpsStats:!1,outsideHider:!0,autoplay:!1,skipStartMenu:!1,invincibility:!1};app;constructor({app:e,name:t}){this.app=e,this.name=t,o.WithWindow((e=>{const t=e.localStorage.getItem(hs);t?this.settings=JSON.parse(t):e.localStorage.setItem(hs,JSON.stringify(this.settings))}))}Init=async e=>{};toggleSetting=e=>{const t=this.settings[e];this.settings[e]=!t,o.WithWindow((e=>{e.localStorage.setItem(hs,JSON.stringify(this.settings))})),o.WithWindow((t=>{switch(e){case"fpsStats":this.app.fps.destroy(),this.app.fps=this.app.construct.fps(),this.app.init.fps();break;case"fullscreen":this.app.fullscreen.destroy(),this.app.fullscreen=this.app.construct.fullscreen(),this.app.init.fullscreen();break;case"gameSpeedSlider":this.app.gameSpeed.destroy(),this.app.gameSpeed=this.app.construct.gameSpeed(),this.app.init.gameSpeed();break;case"outsideHider":this.app.outsideHider.destroy(),this.app.outsideHider=this.app.construct.outsideHider(),this.app.init.outsideHider();break;case"skipStartMenu":break;default:t.location.reload()}}))}}class ds{name;gameHideBottom;gameHideRight;constructor({name:e}){this.name=e,this.gameHideBottom=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.height=O(1e3),t.style.width=O(y),t.style.position="fixed",t.style.top=O(g),t.style.left=O(0),t.style.backgroundColor="white",t.style.zIndex="1",e.document.body.appendChild(t),t})),this.gameHideRight=o.WithWindow((e=>{const t=e.document.createElement("div");return t.style.height=O(1e3),t.style.width=O(1e3),t.style.position="fixed",t.style.top=O(0),t.style.left=O(y),t.style.backgroundColor="white",t.style.zIndex="1",e.document.body.appendChild(t),t}))}Init=async e=>{};destroy=()=>{this.gameHideBottom?.remove(),this.gameHideBottom=void 0,this.gameHideRight?.remove(),this.gameHideRight=void 0}}class ms{name;attributes;constructor({name:e}){this.name=e,this.attributes={gameObjects:{}}}Init=async()=>{};destroy=()=>{};getAndAssertAttribute=({gameObjectId:e,attribute:t})=>{const i=this.attributes.gameObjects[e]?.[t];if(void 0===i){const e=`Attribute:  Attribute "${t}" does not exist.`;console.warn(e)}return i};setAttribute=({gameObjectId:e,attribute:t,value:i})=>{const s=this.attributes.gameObjects[e];void 0===s?this.attributes.gameObjects[e]={[t]:i}:s[t]=i};getAttribute=e=>this.getAndAssertAttribute(e);getNumber=({gameObjectId:e,attribute:t})=>{const i=this.attributes.gameObjects[e]?.[t];if("number"!=typeof i){const e=`Attributes.getNumber: "${t}" expected to be number but is ${i}.`;console.error(e)}return i};getString=({gameObjectId:e,attribute:t})=>{const i=this.attributes.gameObjects[e]?.[t];if("string"!=typeof i){const e=`Attributes.getString: "${t}" expected to be string but is ${i}.`;console.error(e)}return i};getBool=({gameObjectId:e,attribute:t})=>!!this.attributes.gameObjects[e]?.[t];incr=e=>{if("number"!=typeof this.getAndAssertAttribute(e)){const t=`Attribute.incr: Tried to increment ${e.attribute} which is of type ${typeof e.attribute}`;throw o.Alert(t),new Error(t)}this.attributes.gameObjects[e.gameObjectId][e.attribute]+=e.amount};decr=e=>{if("number"!=typeof this.getAndAssertAttribute(e)){const t=`Attribute.decr: Tried to decrement${e.attribute} which is of type ${typeof e.attribute}`;throw o.Alert(t),new Error(t)}this.attributes.gameObjects[e.gameObjectId][e.attribute]-=e.amount};removeGameObject=e=>{delete this.attributes.gameObjects[e]}}const us=[.45342911155358334,.20998925911339794,.18612137419230967,.027337341041047902,.5990317375318044,.8328864008523338,.6469822942734782,.3488065749557574,.37831156223255835,.6530570009752099,.8527245670831858,.4130840440896374,.6966693280345847,.1569304858393712,.11659735072847344,.13885944743589207,.48099024850081973,.8213059821950242,.0019487332315276662,.23417536174600262,.38771398224743725,.5941963949654124,.8489175367517007,.37521649529203116,.0907339802909316,.5696589264910156,.8044609375317521,.9649749155356078,.5841979700215706,.3931906395297904,.06880414604705809,.8872133483751635,.7813401158385685,.9074871066921838,.1787729543114479,.9247901181807967,.011618717472446805,.2521413905723905,.36270989847284374,.3365727304369688,.1322179118984188,.34947977760026105,.4298458177464104,.2525234247691389,.7552605458968171,.458158467665981,.10301808777777732,.8644080071330793,.14603156876133683,.6727105285892682,.04316942321710593,.533388955929811,.10939986427739457,.4209733110411432,.6952540614718076,.6297469834278936,.15000964536875638,.15525161689539102,.15510301086249145,.3658467855194405,.5593121759159684,.04876451827645534,.1537411752292842,.9054909891325366,.0996008318591225,.6517060469483317,.27338958361523213,.0699898858606639,.8383692199836332,.8534084098138357,.2623217405681536,.7845972978372191,.776637452316277,.3267623403642649,.43837954026130166,.3049044458645842,.7422316631257196,.05831210846419721,.8491879839869261,.1870632740519298,.23849471544086942,.5865803245250211,.5166592167137057,.591066595299128,.6904809248550111,.1325342436434589,.6233425591346939,.68084715996548,.686314597431078,.9401943197436007,.12657181848692267,.5995485005785023,.8435669400550748,.5822280576740161,.12049623037340462,.5922634949583211,.6379108037819446,.4663198124404556,.15962469129100532,.8302867442942958,.32204110407079733,.4609081891236191,.6266947188637889,.7845989364743425,.7501585293430187,.04578003101231076,.3797550951051831,.6365896937659042,.8786385187361619,.5883363168330401,.8471608553966083,.4888127570362347,.30817684273255075,.20940902343323564,.6329421269213774,.7009067093251591,.21631126676543466,.8867618366068462,.46477124355751287,.15100001533601082,.440486388744618,.23721370152402443,.45999152259500753,.48684145587728034,.4849035595918899,.885673963478323,.29014573109179,.22370076486773594,.7315852975306489,.5206974568469832,.509369103459025,.13174653929867164,.38590155696121475,.9055570996294409,.5697968179859988,.005225683746957421,.2757193092991943,.5002861069132,.025064988621571027,.5547890649386553,.8971696637220988,.32534153916334996,.7967316856817015,.9267286121098133,.41620238498873907,.5368107474759505,.5908744612643764,.2296619802595673,.8737151987413905,.07173564815938005,.501614728727621,.19464052782600716,.9017953737467099,.5414723854956298,.5223417797802042,.5967274477026533,.8904898345193875,.8659784759512993,.07830025345588931,.5566473324358263,.6017160682066821,.7822251298303049,.530775115093625,.8360145869183621,.6789035177872523,.557171688669119,.3825263119490553,.7163207396960218,.6035779889874906,.02763594736931807,.33010070986691087,.4362435543980697,.6423758906986345,.7509728516391388,.5768909069084682,.7091190183903184,.44877753953627186,.38297221522220737,.07874449296818431,.4835032131927087,.7235984207165743,.13389086487648716,.9073895953400496,.7952234252355878,.5179679010533659,.12579852382987888,.6857725045145211,.06390084520257677,.039001782536820406,.1426107953394269,.6591655521739793,.4590664234844507,.4758315609148345,.7533214450397173,.8468522623403956,.2824198931730678,.07094497283144141,.9495496349917222,.20276041853022264,.04142147250821071,.011531614503970666,.46735305824654894,.38893879922913477,.5858361962954142,.06978547905166965,.4081471641634212,.38275519628649834,.1477720978464525,.20369824901675337,.2616789791199552,.8025851126134029,.9164200298597907,.2662108819411594,.9446077776810641,.44512019255034785,.8863814530559143,.38739482102586986,.2318034159041964,.6410379174441414,.40917081977406256,.0751705369041703,.27524334437562514,.35514982895226355,.7144363430026696,.09610429049291525,.7025150202482875,.5076783104933684,.6931606311070826,.5898803235298529,.2214987691707485,.947671605808515,.09463565604027024,.7632255133296968,.09546924449869232,.9443349397763867,.8985974274322,.5818840158054488,.24903241106629848,.7542946974883376,.7133395185155924,.5399116006849581,.29095562960121746,.516833190986318,.504699443102579,.9564523289003192,.7359033375486135,.13002007858326325,.026418109000740486,.4234672930120388,.5657474263786841,.024497957586039787,.09999535353217237,.31672311950340415,.02160379655767708,.8038467215769727,.5036878170967729,.6626512597684431,.8193703309901822,.49529834995456434,.1750805293963591,.6194152280039915,.2715037764759476,.18075733099250613,.6551055238105191,.8346290541997865,.6147957678042757,.8020723126620772,.8628697052146468,.33526467171941343,.29572527979356655,.06488694155006614,.4465323758492449,.5106951433472819,.010069607975305872,.14888274688995085,.1408905273886839,.007979100922181015,.5321346059990322,.029708417841932344,.9533801003242118,.6909960908804911,.6751897110615098,.5907027826434625,.7284471923446709,.5119820765551601,.8496871359924913,.15231156444106397,.6436866033958034,.49168041389427386,.9315200102143257,.18831930635880034,.5870803364927999,.2358623219869962,.32895314088296257,.655416240831106,.31531841770529523,.6087596747301386,.5154873311277429,.6785172967246165,.30699761406740667,.010636948091472087,.06069510318466331,.24491159004753882,.2443906299277807,.15974390813407446,.22830082472946323,.07563512102633074,.716467068049897,.8104475519179478,.9714333199011672,.22720422145236052,.35486263832025733,.28410223180903416,.37104693956008683,.3275191625685516,.40861877905833255,.9618730525426485,.25956018650322676,.31849490189506313,.778085639848726,.08430723660307515,.7621068662087311,.27670791224113134,.2571611640955924,.18065612713140033,.11029475575862913,.343909914554426,.7022822725271505,.8351901050179695,.8227716547198977,.35416538487147153,.3900830506691869,.6231154496354824,.4369138584289991,.5655167776274332,.2870984229635244,.1418083090174017,.4928104175122726,.02111552761538682,.17353638606262933,.04198585720700909,.09049851348171911,.006991876191562718,.3761591996576138,.5102635529428575,.027162110048963295,.5959234112225362,.34480702611628467,.6159979596063231,.3127353505853274,.15769374826274996,.08899470080446936,.9588038944886659,.2856725487092143,.32080897262077845,.022105749974852373,.15122277698729236,.602698892000337,.05077262978949204,.18550415751702354,.8098769361977355,.3337734399843234,.7391226993280969,.21018966709731057,.29896835333207583,.8045884055011906,.8184089347747813,.7475200612132167,.6785530251297821,.6960924712178518,.3155793570091424,.24577039485402696,.4104897611819843,.6631491654518615,.00886969099106838,.859303562543204,.21024684996529963,.10151540889490529,.1744037178135872,.043220129900908066,.3024363416821967,.9681143375381336,.6902207889274826,.532422624616747,.9575308808392089,.6117439683944171,.8769298402606586,.6491563663360658,.46925543329450303,.45439172896094127,.11848035986122474,.5730528308330627,.6640794649993648,.633125031783523,.6547763473660688,.23952904706255373,.010226617242330427,.49312714676186964,.32737351471501985,.7496197384940984,.3301351582697444,.4637916708181643,.07303987630795716,.1960337293728096,.016902668530450193,.7392450898877357,.9467947194932639,.48626471766378343,.29034758101717706,.2663085956067971,.026537535387719857,.4055613708683422,.45014220823905926,.39802948840708285,.4864408151131535,.6973367407280233,.2671619215069323,.1298051653517921,.5074381455873747,.5301713073049528,.20314082926078592,.8717607277000436,.8878581383250479,.02639283488691957,.24661208551145897,.07189937562558324,.9482319080218947,.06867937495801135,.352867057142207,.49177880505852456,.752028987615873,.14347116870058096,.7688232727786954,.2710203555057561,.4382813922376686,.6516636830544357,.9915471990418079,.14564005286590753,.8317137847988453,.4954735658545769,.8324602212021448,.8167005080316413,.5035118019970211,.2705982086113031,.13980020625207956,.607987827956459,.6202184945967391,.5641262010895497,.37557135848127454,.2609061408997505,.9859928018409161,.43463155035183343,.4884259625417736,.36548360992536455,.9183510845165952,.794155590077841,.1458159571597345,.40420926826025505,.29530650261505,.30696043276931295,.5044628705928101,.451544953471843,.7827126219065461,.7171818647990341,.32681317141674815,.20421528187198568,.45338930915934994,.1792196798638266,.9200263599041653,.3797827512356471,.9634348099052868,.9627499668043282,.9860041377837834,.8423115803870962,.5905427785219192,.4524320329689594,.9855954585697416,.6267571582460864,.43219629315489927,.6953087254172033,.35647300556978423,.49903586749507933,.8238834356156521,.6111239482572478,.5973497390821749,.6822152991850362,.9119702679900069,.5105361017623579,.4158619634480828,.6841622033977972,.27847166933627,.00029598742108882803,.0518639716896645,.9703461770192158,.3303546931873522,.9428872489520835,.5911685687755772,.11506806332296726,.4247585079282027,.19183795003781878,.4008839913706428,.6081563671075925,.8570670122593256,.608121515607326,.44606678358064955,.825084342650976,.2615507829401321,.29301008987880917,.013386754747460983,.8732399408134618,.12168685960891779,.6998813714835274,.1772822128915571,.004817599699285524,.80607519755682,.7222406858890835,.5530891948512798,.8308401926505975,.7251873129239758,.58170261200732,.4671657741080698,.5760226528662062,.6551988429388999,.344572311729739,.9319938839561656,.5433700907560043,.4098563525821576,.5404055044300952,.9148442285908837,.3225782436280614,.9304390876009332,.4741206994592282,.785213601895292,.9939762665969524,.12248612567856154,.3835944018196894,.9123175915861125,.4603494879722665,.9533429781803506,.14571245764595375,.7370984821070116,.27960215613301087,.8422011270661844,.45931767251859146,.4232283264454564,.11111583533800518,.2034563282445191,.7816556871717766,.1257334459037206,.6842012494372544,.21470411269722678,.6372101687494216,.23977477542793235,.7879648223727501,.8284207462941362,.051149517287465085,.06008800867867026,.2563692949297586,.9450902765484713,.20371179730769418,.6537660957769187,.9710185108046395,.816945590735005,.5001018775384983,.349025141295497,.16539607758147135,.9803660363248653,.9257187317212812,.5626978021425406,.20187058384962453,.8619261713059228,.7247125617030087,.5409228792544916,.4143264634984277,.8737670367840897,.6895999795800103,.920683099135772,.19804785239672462,.9049782893123396,.6386524282992487,.852374934008493,.08424926276987355,.9674804797724592,.8266066305367814,.3390529850188375,.5278409584468753,.673466852289968,.040733889527211464,.9207564252663359,.5177036030406827,.0778461335051509,.08473901246697568,.44553591967787765,.7910861889990741,.6597112829917101,.9283611118218704,.6810385339877619,.27623482884286166,.7663050423554953,.30323233389752124,.4402350874291048,.3226228378331506,.4304209632888426,.62536021652455,.9605240811692883,.5576426630860302,.6002247424271174,.6282374602867792,.9416537779918817,.5998895741141518,.9516451887986123,.8279189263663397,.44429662719239593,.9203459478579357,.7223658751658704,.4813251456446507,.6774439689840445,.026093702146061215,.4948337394278526,.6881132273503798,.9344524350151341,.37778543603583836,.7723122933231058,.4455288630141979,.7134496468003916,.34937381928788136,.00045540062552740235,.6292864796881406,.9518108966729648,.4149450591749845,.9693638345033263,.12138005399817342,.8516773560096759,.29504361931587364,.864871206749366,.8068189421758797,.7894383183788646,.07268409205725146,.43960179604096106,.020244354548051513,.4269337719175833,.37851937915900524,.15010141488846962,.08935901370459831,.8679681327286262,.01268456546602481,.5676744162541304,.39754174153971966,.42738583250806916,.32690568445271606,.1199424777452357,.10842940472050033,.5349035505899369,.6422655402579591,.29973867248015773,.26602368451530123,.2097470822460088,.5974239000407021,.40349163342229655,.7192028003603015,.49054150053600154,.12618861541909598,.5391531791441994,.7757636780689012,.03749170480590014,.8016501863978885,.0535408482555535,.930040758677184,.5639072529479398,.053245785129787615,.5116289222618626,.43531210012697585,.46396094530757603,.3443518040831678,.3683251067114557,.7281030941022802,.9196943498116169,.8231940161535984,.7986558847231163,.5624291121245543,.618390328460952,.4497146414715285,.8897925177071072,.15223272835512225,.8675385608065856,.5240622441176133,.8041495867456385,.1779971300100729,.46653728201686606,.18770984863136653,.3328270724515564,.49617668746395993,.31589389363301423,.5947244473852669,.3114471272709689,.9661120413463464,.7946299516020876,.008599257124507265,.04975093483901705,.11578667647562901,.22152808379535438,.11712403161145857,.6579566099892291,.14654024122842657,.635695412418967,.10789559998794362,.15379867301626715,.4036210519052168,.027841876280158218,.9055311010311431,.2993441530396921,.8299295940326633,.8006217431661866,.949607836120248,.06227474784217635,.22259106332375744,.7371676539963831,.8419805088012849,.5654588564498728,.4248963816507426,.5447275256218286,.052566937592315344,.9667664388569297,.842263155428235,.31410087954048227,.6596024819691246,.4594685122829886,.08782503520522722,.37491817466284916,.9951515896189063,.029674726207426838,.3917189920058023,.9409537466417993,.5956813736140938,.8291907204995701,.5296192927797034,.7724909554987716,.16532970730460617,.5846613292896644,.579947842685139,.19988411518840787,.9191252059096966,.20045325891704735,.09937033226771597,.7039302002409996,.3756161874775287,.15911500268770395,.7017721463706623,.19187064706649526,.15495052506009765,.9974213706252504,.632535824877206,.49253280855125803,.8105940643791348,.04243949732136343,.34250771806320535,.8557923660044925,.5601425058332472,.39261788223416183,.6706829869739274,.7777331941965681,.0726408674003921,.38664594211496617,.04321975773006581,.4127137292301968,.7277227964526509,.11336012273085472,.12175898606138202,.6245472161401031,.3336975535824035,.493800621302948,.19111064350110119,.47046491213063235,.05791562382009663,.7279102252715404,.192269865215295,.9862073483471555,.25546000480993536,.3721382962246764,.01059185919817196,.31015934407809354,.22854850398628745,.8264869862938667,.9091280111385117,.43081832370560424,.6375851981942199,.37702054212560754,.19367014293738116,.40574966268585877,.2506394622718605,.4962604829351551,.057891649840694615,.2265198250362338,.32233173386639624,.08964479072490594,.3306572193716799,.2652629321886011,.6741058826632355,.1569943680447673,.490404716345036,.10727597780649267,.4272713160430588,.19495398709083722,.019293276894112088,.42288354534623795,.6711986381615292,.8909592266311835,.4810771889745955,.9203001797477391,.3802728784874255,.0386553690097704,.5187012542011515,.773272779029089,.759623921342993,.7666688587575902,.8114026149224782,.5402569196969043,.2624254637035539,.24100239940317936,.6360733545175751,.4847657380397401,.8745943757485344,.643210008823184,.1415640557935285,.12021974449816919,.36703898864725804,.05679584830351947,.5172885113456015,.39154752645808466,.6094519381486375,.4419609603845074,.30806670513115497,.11234526788571564,.7077265126165719,.750479889493471,.25197536824389444,.3715267452003659,.7619483423689891,.5960597172652877,.8577107261929101,.6931114392499593,.8899601182953346,.000972811536398388,.532383432255118,.8634040076438961,.38768264132535557,.7612457754325722,.6736096959257997,.0602684881481409,.09681005437384804,.7502011355462022,.06222267727295361,.07678705703818556,.3350171946080127,.8105138136352623,.4177292701658555,.1481147229428461,.8822579894474968,.11251598946875063,.03687740589709787,.45656166084239747,.2548279757149182,.8360022149956545,.5692610055166762,.1001205897854438,.9515119632445794,.47273286484720656,.6537027978154046,.3737726332994423,.2088722222311401,.1794961290087419,.16159262131135654,.39118471767178675,.3287817098270296,.18581727184529728,.7321396854432284,.7909914095941968,.45219554052587263,.785390986194817,.2063290982572722,.5293265595254864,.5264436229222416,.00821075089726997,.2940608536263195,.9400132693157197,.4169687366089372,.8170294136748304,.6116896474929273,.27036731326240715,.37065512131459033,.43581018883376954,.5438466367576568,.4454829915900046,.04410035434054582,.5365288314294756,.8416436368460464,.45607054821143445,.03318271201039724,.3392730454358185,.5662878863574784,.7731273563036101,.1153564229952595,.05391688179599852,.24507651194830193,.6204404928080974,.09868282391747041,.6401666756260284,.069318098295726,.8582249741696631,.1967716563008467,.21174078961463216,.36527395371003846,.626985760210665,.2735219359244704,.4079324415342266,.6994536228645047,.8336459312462464,.3853842776596741,.3748588355242274,.6186824209717986,.6751778614212678,.8597579283143703,.7757187613517933,.12376731993713497,.9891246177550149,.3341660422647347,.02925039742753599,.762264474943544,.5984939390679952,.7157056691237071,.020149568060134126,.8247838963941948,.2587422300770904,.15034705844765917,.4671590888352699,.7705764691185887,.7718534104743849,.6766536026566439,.5759865806813399,.15852347962918423,.7401095657707564,.2515639426653521,.4586093045820384,.8987497733636222,.8755936196185189,.4289034478985627,.1883523697402466,.1259975771519759,.7328851220562034,.3185391750841573,.5765702504779808,.0227432181522097,.6207047375534971,.6690315240334439,.2626242859845781,.8993229734739256,.4543482829199239,.4405298256938116,.10129454293151341,.6492480074038013,.4970733243051595,.825535840142815,.5282601784417414,.28155350463086004,.3241056465318788,.6717794692226744,.5177504188200349,.21942510409357785,.8386004728221148,.39674242338759214,.6696950094707798,.9464331928429409,.2012098946750076,.2927372944085215,.7629763967800943,.6182795562484132,.6943408015072152,.8420337694464215,.8523869935021142,.22502225498157846,.9508654442764254,.22352326932049404,.7476433370802689,.8660059788198433,.015657657741847686,.4738694949897706,.440790514090716,.3986242366281054,.00498373964123322,.06351777200020803,.6609875289223586,.16382048367229263,.30328390828574925,.3244009919527677,.09869374007700737,.024042436132946987,.017098193893456348,.5723319731257346,.476794573593336,.34309796598590425];class ys{name;currentIndex;constructor({name:e}){this.name=e,this.currentIndex=0}Init=async()=>{};destroy=()=>{};randomInt=(e,t)=>{const i=us[this.currentIndex];this.currentIndex=(this.currentIndex+1)%us.length;const s=Math.ceil(e),n=Math.floor(t);return Math.floor(i*(n-s+1)+s)}}class gs{name="noop";Init=async()=>{};destroy=()=>{}}class fs{name;frameCount=0;replay;events;constructor({name:e}){this.name=e}Init=async e=>{this.replay=(await s((async()=>{const{replay:e}=await import("./replay.js");return{replay:e}}),[])).replay,this.events=e?.events,this.events.subscribeToEvent(this.name,(e=>{"frame_tick"===e.type&&(this.frameCount=e.frameNr)}))};get ButtonsPressed(){const e=`${this.frameCount}`,t={start:!1,down:!1,left:!1,right:!1,shoot:!1,laser:!1,up:!1};return e in this.replay.inputs?{...t,...this.replay.inputs[e]}:t}}class vs{name;scale=1;constructor({name:e}){this.name=e}Init=async()=>{};destroy=()=>{}}class bs{name;constructor({name:e}){this.name=e}Init=async()=>{};Dispatch=e=>({type:"responseVoid"});destroy=()=>{}}class xs{name;FrameCount;frameSpeedMultiplier;app;constructor({app:e,name:t}){this.app=e,this.name=t,this.FrameCount=0,this.frameSpeedMultiplier=1}Init=async()=>{};Start=()=>{o.SetInterval(this.oneGameLoop,0)};pause=()=>{this.frameSpeedMultiplier=0};nextFrame=()=>{this.FrameCount++,this.app.events.dispatchEvent({type:"frame_tick",frameNr:this.FrameCount})};advanceFrames=()=>{0!==this.frameSpeedMultiplier&&this.nextFrame()};oneGameLoop=()=>{0!==this.frameSpeedMultiplier&&this.advanceFrames()}}class ws{name;FrameCount;nextFrameMillis;frameSpeedMultiplier;app;constructor({app:e,name:t}){this.app=e,this.name=t,this.FrameCount=0,this.nextFrameMillis=null,this.frameSpeedMultiplier=1}Init=async()=>{};Start=()=>{this.nextFrameMillis=o.PerformanceNow()+f,o.RequestAnimationFrame(this.oneGameLoop)};pause=()=>{this.frameSpeedMultiplier=0};nextFrame=()=>{this.FrameCount++,this.app.events.dispatchEvent({type:"frame_tick",frameNr:this.FrameCount}),this.app.eventsEndOfFrame.dispatchEvent({type:"end_of_frame",frameNr:this.FrameCount})};advanceFrames=()=>{for(let e=0;e<this.frameSpeedMultiplier;e++)this.nextFrame()};tooSlowFrames=0;oneGameLoop=e=>{if(o.RequestAnimationFrame(this.oneGameLoop),null===this.nextFrameMillis)throw o.Alert("this.nextFrameMillis === null"),new Error("this.nextFrameMillis === null");let t=0;for(;e>=this.nextFrameMillis;)t++,this.nextFrameMillis+=f,this.advanceFrames();t>1&&(this.tooSlowFrames+=t-1,console.info(`A total of ${this.tooSlowFrames} frames executed too slow!`))}}class Ss{name;history=[];attributes;events;constructor({name:e}){this.name=e}Init=async e=>{this.events=e?.events,this.attributes=e?.attributes,this.events.subscribeToEvent(this.name,this.onEvent)};onEvent=e=>{if("gameOver"===e.type&&(console.log("E2eRecordEvents.history:"),console.log(this.history)),"frame_tick"===e.type){const t=e.frameNr-1;if(t<0)return;this.history[t]||(this.history[t]={});const i=this.attributes.attributes;for(const[e,s]of Object.entries(i.gameObjects))this.history[t][e]=s?.hp}}}o.WithWindow((()=>{const e={circle:new Image,square:new Image,triangle:new Image,diamondShield:new Image,octagon:new Image,explosion:new Image,roundExplosion:new Image};return e.circle.src="/schmupinator/images/circle.png",e.square.src="/schmupinator/images/square.png",e.triangle.src="/schmupinator/images/triangle.png",e.diamondShield.src="/schmupinator/images/diamondShield.png",e.octagon.src="/schmupinator/images/octagon.png",e.explosion.src="/schmupinator/images/explosion.png",e.roundExplosion.src="/schmupinator/images/roundExplosion.png",e})),o.WithWindow((()=>{const e={circle:new Image,square:new Image,triangle:new Image,diamondShield:new Image,octagon:new Image,explosion:new Image,roundExplosion:new Image};return e.circle.src="/schmupinator/images/circle.png",e.square.src="/schmupinator/images/square.png",e.triangle.src="/schmupinator/images/triangle.png",e.diamondShield.src="/schmupinator/images/diamondShield.png",e.octagon.src="/schmupinator/images/octagon.png",e.explosion.src="/schmupinator/images/explosion.png",e.roundExplosion.src="/schmupinator/images/roundExplosion.png",e}));const Is=!!e();class As{cursorShowGamePos;e2eTest;settings;input;gameLoop;fps;enemies;gamepad;collisions;events;eventsCollisions;eventsEndOfFrame;eventsUi;eventsPoints;gameSpeed;points;highscore;gameData;graphics;ui;fullscreen;outsideHider;attributes;pseudoRandom;constructor(){this.settings=new cs({app:this,name:"settings"});const{autoplay:t}=this.settings.settings;this.cursorShowGamePos=this.construct.cursorShowGamePos(),this.e2eTest=e()?Is?new gs:new Ss({name:"e2e"}):new ps({name:"e2e"}),this.input=e()?t?new fs({name:"input"}):new W({name:"input"}):new fs({name:"input"}),this.gameLoop=e()?new ws({app:this,name:"gameLoop"}):new xs({app:this,name:"nodeGameLoop"}),this.fps=this.construct.fps(),this.enemies=new _({name:"enemies"}),this.gamepad=new U({name:"gamePad"}),this.collisions=new G({name:"collisions"}),this.events=new L({app:this,name:"events"}),this.eventsCollisions=new L({app:this,name:"eventsCollisions"}),this.eventsEndOfFrame=new L({app:this,name:"eventsEndOfFrame"}),this.eventsUi=new L({app:this,name:"eventsUi"}),this.eventsPoints=new L({app:this,name:"eventsPoints"}),this.gameSpeed=this.construct.gameSpeed(),this.points=new $({app:this,name:"points"}),this.highscore=new z({name:"highscore"}),this.gameData=new Oi({name:"gameData"}),this.graphics=e()?new Ri({name:"graphics"}):new bs({name:"mockGraphics"}),this.ui=e()?new rs({name:"ui"}):new gs,this.fullscreen=this.construct.fullscreen(),this.outsideHider=this.construct.outsideHider(),this.attributes=this.construct.attributes(),this.pseudoRandom=this.construct.pseudoRandom()}construct={attributes:()=>new ms({name:"attributes"}),cursorShowGamePos:()=>e()?Is?new gs:new r({name:"cursorShowGamePos"}):new gs,fps:()=>{const{fpsStats:t}=this.settings.settings;return e()&&t?new M({app:this,name:"fps"}):new gs},fullscreen:()=>{const{fullscreen:t}=this.settings.settings;return e()&&t?new ls({name:"fullscreen"}):new vs({name:"mockFullscreen"})},gameSpeed:()=>{const{gameSpeedSlider:t}=this.settings.settings;return e()&&t?new R({name:"gameSpeed"}):new gs},outsideHider:()=>{const{outsideHider:t}=this.settings.settings;return e()&&t?new ds({name:"hider"}):new gs},pseudoRandom:()=>new ys({name:"pseudoRandom"})};Init=async()=>{const{attributes:e,enemies:t,events:i,eventsEndOfFrame:s,eventsCollisions:n,eventsPoints:a,eventsUi:o,gameLoop:r,gamepad:l,graphics:p,highscore:h,input:c,points:d,pseudoRandom:m,gameData:u,settings:y}=this;await u.Init(),await this.e2eTest.Init({attributes:e,events:i}),await this.init.cursorShowGamePos(),await y.Init(),await c.Init({events:i}),await r.Init(),await this.init.fps(),await this.collisions.Init({attributes:e,enemies:t,events:i,eventsCollisions:n}),await t.Init({attributes:e,events:i,eventsCollisions:n,eventsPoints:a,graphics:p,gameData:u,gamepad:l,input:c,pseudoRandom:m,settings:y}),await l.Init(),await this.events.Init(),await this.eventsCollisions.Init(),await this.eventsPoints.Init(),await this.eventsUi.Init(),await this.init.gameSpeed(),await this.points.Init(),await this.graphics.Init({eventsEndOfFrame:s}),await this.ui.Init({events:i,eventsUi:o,gameLoop:r,highscore:h,input:c,points:d,settings:y,gameData:u}),await this.highscore.Init({gameData:u}),await this.init.fullscreen(),await this.init.outsideHider(),await this.init.attributes(),await this.init.pseudoRandom()};init={attributes:async()=>{await this.attributes.Init()},cursorShowGamePos:async()=>{const{fullscreen:e}=this;await this.cursorShowGamePos.Init({fullscreen:e})},fps:async()=>{await this.fps.Init()},fullscreen:async()=>{await this.fullscreen.Init()},gameSpeed:async()=>{const{gameLoop:e,settings:t}=this;await this.gameSpeed.Init({gameLoop:e,settings:t})},outsideHider:async()=>{await this.outsideHider.Init()},pseudoRandom:async()=>{await this.pseudoRandom.Init()}}}o.OnLoad((async()=>{const t=new As;await t.Init(),e()||t.gameLoop.Start()}));const Ts=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
